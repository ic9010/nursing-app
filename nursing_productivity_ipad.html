<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Nursing Productivity">
<title>Nursing Productivity System ‚Äì Kalicia Szabo</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#f8fafc; --card:#ffffff; --text:#0f172a; --muted:#64748b;
  --accent:#2563eb; --accent-light:#dbeafe; --success:#16a34a;
  --warning:#d97706; --danger:#dc2626; --border:#e5e7eb;
  --shadow:0 2px 4px rgba(0,0,0,0.08); --shadow-lg:0 12px 32px rgba(0,0,0,0.12);
}
.dark {
  --bg:#020617; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8;
  --accent-light:#1e3a8a; --border:#1e293b;
  --shadow:0 2px 4px rgba(0,0,0,0.4); --shadow-lg:0 12px 32px rgba(0,0,0,0.5);
}
* { box-sizing:border-box; margin:0; padding:0; -webkit-tap-highlight-color:transparent; }
body {
  background:var(--bg);
  background-image:url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=2070&auto=format&fit=crop');
  background-size:cover; background-position:center; background-attachment:fixed;
  color:var(--text); font-family:'Poppins',-apple-system,sans-serif; line-height:1.6;
  touch-action:pan-y; -webkit-user-select:none; user-select:none; overflow-x:hidden;
}
input,textarea { -webkit-user-select:text; user-select:text; }
body::before {
  content:''; position:fixed; top:0; left:0; right:0; bottom:0;
  background:rgba(248,250,252,0.85); z-index:-1; transition:background 0.3s;
}
body.dark::before { background:rgba(2,6,23,0.92); }
body.dark { background-image:url('https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=2070&auto=format&fit=crop'); }
.container { max-width:1024px; margin:auto; padding:24px; }
#confetti-canvas { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; }

header {
  background:rgba(255,255,255,0.95); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border:1px solid var(--border); border-radius:20px; padding:28px; margin-bottom:28px;
  box-shadow:var(--shadow-lg); display:flex; justify-content:space-between; align-items:center; gap:20px;
}
.dark header { background:rgba(15,23,42,0.95); }
.header-left { display:flex; align-items:center; gap:20px; flex:1; }
.logo-container {
  width:90px; height:90px; background:linear-gradient(135deg,#dc2626,#991b1b);
  border-radius:16px; display:flex; align-items:center; justify-content:center;
  box-shadow:var(--shadow-lg); flex-shrink:0;
}
.logo-text { color:white; font-weight:700; font-size:36px; letter-spacing:-1px; }
.header-info h1 {
  font-family:'Playfair Display',serif; font-size:38px; font-weight:900; margin-bottom:6px;
  background:linear-gradient(135deg,#2563eb,#7c3aed); -webkit-background-clip:text;
  -webkit-text-fill-color:transparent; background-clip:text; letter-spacing:-0.5px;
}
.header-info .subtitle { color:var(--muted); font-size:15px; display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.badge { background:var(--accent-light); color:var(--accent); padding:6px 12px; border-radius:8px; font-size:13px; font-weight:600; }

button {
  padding:14px 22px; border-radius:12px; border:1px solid var(--border); background:var(--card);
  color:var(--text); cursor:pointer; font-weight:500; transition:all 0.2s; box-shadow:var(--shadow);
  font-size:16px; min-height:48px; min-width:48px; touch-action:manipulation;
}
button:active { transform:scale(0.96); background:var(--accent-light); }
.btn-primary { background:var(--accent); color:white; border-color:var(--accent); }
.btn-primary:active { background:#1d4ed8; }

.ipad-grid { display:grid; grid-template-columns:1fr 1fr; gap:24px; margin-bottom:28px; }
.grid { display:grid; grid-template-columns:repeat(2,1fr); gap:20px; margin-bottom:28px; }

.card {
  background:rgba(255,255,255,0.95); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border:1px solid var(--border); border-radius:20px; padding:24px; box-shadow:var(--shadow);
}
.dark .card { background:rgba(15,23,42,0.95); }
.card h3 { font-size:14px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:14px; }
.stat { font-size:40px; font-weight:700; background:linear-gradient(135deg,var(--accent),#7c3aed); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.stat-label { color:var(--muted); font-size:13px; margin-top:6px; }

.graduation-card {
  background:linear-gradient(135deg,#7c3aed,#2563eb); color:white;
  padding:28px; border-radius:20px; box-shadow:var(--shadow-lg); margin-bottom:28px;
  position:relative; overflow:hidden;
}
.graduation-card::before { content:'üéì'; position:absolute; top:-20px; right:-20px; font-size:120px; opacity:0.15; }
.graduation-card h2 { font-family:'Playfair Display',serif; font-size:32px; font-weight:900; margin-bottom:12px; position:relative; }
.graduation-card .countdown { font-size:52px; font-weight:700; margin:16px 0; position:relative; }
.graduation-card .subtitle { font-size:16px; opacity:0.9; position:relative; }
.graduation-card .grad-date { font-size:13px; opacity:0.7; margin-top:6px; position:relative; }

.filter-tabs { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
.filter-tab {
  padding:10px 18px; border-radius:10px; background:var(--card); border:1px solid var(--border);
  cursor:pointer; font-size:14px; font-weight:500; transition:all 0.2s; min-height:44px;
}
.filter-tab.active { background:var(--accent); color:white; border-color:var(--accent); }
.filter-tab:active { transform:scale(0.95); }

.task-form { display:flex; flex-direction:column; gap:14px; margin-bottom:20px; }
.task-form input,.task-form select {
  padding:14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px; font-family:inherit;
}
.task-form input:focus,.task-form select:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.task-item {
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  padding:16px; margin-bottom:12px; display:flex; align-items:center; gap:14px; transition:all 0.2s;
}
.task-item.done { opacity:0.6; }
.task-item.done .task-text { text-decoration:line-through; }
.task-checkbox {
  width:28px; height:28px; border-radius:50%; border:2px solid var(--border);
  cursor:pointer; flex-shrink:0; display:flex; align-items:center; justify-content:center;
  transition:all 0.2s; min-width:28px; min-height:28px;
}
.task-checkbox.checked { background:var(--success); border-color:var(--success); color:white; }
.task-content { flex:1; }
.task-text { font-weight:500; font-size:15px; margin-bottom:4px; }
.task-meta { display:flex; gap:10px; font-size:12px; color:var(--muted); flex-wrap:wrap; }
.priority-high { border-left:4px solid var(--danger); }
.priority-medium { border-left:4px solid var(--warning); }
.priority-low { border-left:4px solid var(--accent); }
.task-actions button { padding:8px 12px; min-width:auto; min-height:36px; font-size:14px; }

.timer-display {
  font-size:64px; font-weight:700; text-align:center; margin:24px 0; font-variant-numeric:tabular-nums;
  background:linear-gradient(135deg,var(--accent),#7c3aed); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}
.timer-controls { display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-bottom:20px; }
.timer-presets { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px; }
.preset-btn { padding:12px; font-size:14px; }
.preset-btn.active { background:var(--accent); color:white; border-color:var(--accent); }
.custom-timer { display:flex; gap:10px; align-items:center; margin-bottom:20px; }
.custom-timer input {
  flex:1; padding:12px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px;
}
.custom-timer input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.calc-grid { display:grid; gap:14px; margin-bottom:20px; }
.calc-input { display:flex; flex-direction:column; gap:8px; }
.calc-input label { font-size:13px; font-weight:600; color:var(--muted); }
.calc-input input,.calc-input select {
  padding:14px; border-radius:10px; border:1px solid var(--border); background:var(--card); color:var(--text); font-size:15px;
}
.calc-input input:focus,.calc-input select:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }
.calc-result { background:var(--accent-light); color:var(--accent); padding:18px; border-radius:12px; text-align:center; font-size:18px; font-weight:600; margin-top:14px; }

textarea {
  width:100%; padding:14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px; font-family:inherit; resize:vertical; min-height:180px;
}
textarea:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.checklist { display:flex; flex-direction:column; gap:12px; }
.checklist-item {
  display:flex; align-items:center; gap:12px; padding:14px;
  background:var(--card); border:1px solid var(--border); border-radius:10px;
}
.checklist-item input[type="checkbox"] { width:24px; height:24px; cursor:pointer; min-width:24px; min-height:24px; }
.checklist-item label { flex:1; cursor:pointer; font-size:15px; }

.calendar-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
.calendar-header h3 { font-size:20px; font-weight:700; text-transform:none; }
.calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; }
.calendar-day-header { text-align:center; font-size:12px; font-weight:600; color:var(--muted); padding:10px; }
.calendar-day {
  aspect-ratio:1; display:flex; align-items:center; justify-content:center;
  border-radius:10px; cursor:pointer; transition:all 0.2s; position:relative;
  background:var(--card); border:1px solid var(--border); min-height:52px;
}
.calendar-day.today { background:var(--accent-light); border-color:var(--accent); font-weight:600; }
.calendar-day.selected { background:var(--accent); color:white; border-color:var(--accent); }
.calendar-day.has-tasks::after { content:''; position:absolute; bottom:6px; width:6px; height:6px; background:var(--accent); border-radius:50%; }
.calendar-day.selected.has-tasks::after { background:white; }
.calendar-day.other-month { opacity:0.3; cursor:default; }
.calendar-day-number { font-size:15px; font-weight:500; }

.event-item { background:var(--card); border:1px solid var(--border); border-radius:10px; padding:14px; margin-bottom:10px; }
.event-item.priority-high { border-left:4px solid var(--danger); }
.event-item.priority-medium { border-left:4px solid var(--warning); }
.event-item.priority-low { border-left:4px solid var(--accent); }
#dayEvents { margin-top:20px; padding:20px; background:rgba(255,255,255,0.5); border-radius:12px; min-height:120px; }
.dark #dayEvents { background:rgba(15,23,42,0.5); }

.empty-state { text-align:center; color:var(--muted); padding:40px 20px; font-size:15px; }
.empty-state::before { content:'üìã'; display:block; font-size:48px; margin-bottom:12px; }

.med-search { margin-bottom:20px; }
.med-search input {
  width:100%; padding:14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px;
}
.med-search input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }
.med-results { max-height:400px; overflow-y:auto; }
.med-item {
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  padding:16px; margin-bottom:12px; cursor:pointer; transition:all 0.2s;
}
.med-item:active { transform:scale(0.98); background:var(--accent-light); }
.med-name { font-weight:600; font-size:16px; margin-bottom:6px; color:var(--accent); }
.med-class { font-size:13px; color:var(--muted); margin-bottom:4px; }
.med-detail { background:var(--card); border:1px solid var(--border); border-radius:10px; padding:20px; margin-top:14px; }
.med-detail h4 { font-size:15px; font-weight:600; margin-bottom:8px; margin-top:16px; color:var(--accent); }
.med-detail h4:first-child { margin-top:0; }
.med-detail p,.med-detail ul { font-size:14px; line-height:1.6; margin-bottom:8px; }
.med-detail ul { padding-left:20px; }

.photo-upload-container { margin-top:14px; }
.photo-upload-btn {
  width:100%; padding:14px; background:var(--accent-light); color:var(--accent);
  border:2px dashed var(--accent); border-radius:10px; cursor:pointer; font-weight:600;
  display:flex; align-items:center; justify-content:center; gap:8px; transition:all 0.2s;
}
.photo-upload-btn:hover { background:var(--accent); color:white; }
#photoInput { display:none; }
.photo-preview-container { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:12px; margin-top:14px; }
.photo-preview { position:relative; border-radius:10px; overflow:hidden; aspect-ratio:1; background:var(--border); }
.photo-preview img { width:100%; height:100%; object-fit:cover; }
.photo-delete {
  position:absolute; top:4px; right:4px; background:var(--danger); color:white;
  border:none; border-radius:50%; width:28px; height:28px; min-width:28px; min-height:28px;
  padding:0; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:16px;
}

.tab-container { display:flex; gap:10px; margin-bottom:20px; border-bottom:2px solid var(--border); }
.tab {
  padding:12px 20px; background:transparent; border:none; border-bottom:3px solid transparent;
  cursor:pointer; font-weight:500; font-size:15px; color:var(--muted); transition:all 0.2s;
  min-height:auto; box-shadow:none;
}
.tab.active { color:var(--accent); border-bottom-color:var(--accent); }
.tab-content { display:none; }
.tab-content.active { display:block; }
</style>
</head>
<body>
<canvas id="confetti-canvas"></canvas>
<div class="container">
  <header>
    <div class="header-left">
      <div class="logo-container"><div class="logo-text">KJ</div></div>
      <div class="header-info">
        <h1>Kalicia Szabo</h1>
        <div class="subtitle"><span>Nursing Student</span><span class="badge">ADN Program</span></div>
      </div>
    </div>
    <button id="themeBtn">üåô</button>
  </header>

  <div class="graduation-card">
    <h2>üéì Graduation Countdown</h2>
    <div class="countdown" id="graduationCountdown">Loading...</div>
    <div class="subtitle">Days until you become a Registered Nurse!</div>
    <div class="grad-date">üóìÔ∏è Target: December 5, 2026</div>
  </div>

  <div class="grid">
    <div class="card">
      <h3>Tasks This Week</h3>
      <div class="stat" id="weekTaskCount">0</div>
      <div class="stat-label">Total tasks</div>
    </div>
    <div class="card">
      <h3>Completed Today</h3>
      <div class="stat" id="completedCount">0</div>
      <div class="stat-label">Tasks done</div>
    </div>
  </div>

  <div class="ipad-grid">
    <div>
      <div class="card">
        <h3>üìù Task Manager</h3>
        <div class="filter-tabs">
          <div class="filter-tab active" data-filter="all">All</div>
          <div class="filter-tab" data-filter="today">Today</div>
          <div class="filter-tab" data-filter="week">Week</div>
        </div>
        <div class="task-form">
          <input type="text" id="taskInput" placeholder="Enter task description...">
          <select id="taskSubject">
            <option>Pharmacology</option><option>Med-Surg</option><option>Fundamentals</option>
            <option>Mental Health</option><option>Pediatrics</option><option>OB/GYN</option>
            <option>Clinical</option><option>Study</option><option>Personal</option>
          </select>
          <select id="taskPriority">
            <option value="high">High Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="low">Low Priority</option>
          </select>
          <input type="date" id="taskDate">
          <button id="addTaskBtn" class="btn-primary">Add Task</button>
        </div>
        <div id="taskList"></div>
      </div>

      <div class="card" style="margin-top:24px;">
        <h3>‚è±Ô∏è Pomodoro Timer</h3>
        <div class="timer-presets">
          <button class="preset-btn active" data-minutes="25">25 min</button>
          <button class="preset-btn" data-minutes="15">15 min</button>
          <button class="preset-btn" data-minutes="45">45 min</button>
          <button class="preset-btn" data-minutes="60">60 min</button>
        </div>
        <div class="custom-timer">
          <input type="number" id="customMinutes" placeholder="Custom minutes" min="1" max="180">
          <button id="setCustomTimerBtn">Set</button>
        </div>
        <div class="timer-display" id="timerDisplay">25:00</div>
        <div class="timer-controls">
          <button id="startTimerBtn" class="btn-primary">Start</button>
          <button id="pauseTimerBtn">Pause</button>
          <button id="resetTimerBtn">Reset</button>
        </div>
      </div>
    </div>

    <div>
      <div class="card">
        <div class="calendar-header">
          <button id="prevMonthBtn">‚Üê</button>
          <h3 id="calendarMonth">Month Year</h3>
          <button id="nextMonthBtn">‚Üí</button>
        </div>
        <div id="calendar" class="calendar-grid"></div>
        <div id="dayEvents"></div>
      </div>

      <div class="card" style="margin-top:24px;">
        <h3>üíä Medication Database</h3>
        <div class="med-search"><input type="text" id="medSearch" placeholder="Search medications..."></div>
        <div class="med-results" id="medResults"></div>
      </div>
    </div>
  </div>

  <div class="ipad-grid">
    <div class="card">
      <h3>üíâ Calculators</h3>
      <div class="tab-container">
        <button class="tab active" data-tab="dosage">Dosage</button>
        <button class="tab" data-tab="iv">IV Drip Rate</button>
      </div>
      <div id="dosageTab" class="tab-content active">
        <div class="calc-grid">
          <div class="calc-input"><label>Ordered Dose (mg)</label><input type="number" id="ordered" placeholder="e.g., 500" step="0.01"></div>
          <div class="calc-input"><label>Available Strength (mg)</label><input type="number" id="available" placeholder="e.g., 250" step="0.01"></div>
          <div class="calc-input"><label>Available Volume (mL)</label><input type="number" id="volume" placeholder="e.g., 5" step="0.01"></div>
        </div>
        <button id="calculateBtn" class="btn-primary" style="width:100%;">Calculate Dose</button>
        <div id="doseOutput"></div>
      </div>
      <div id="ivTab" class="tab-content">
        <div class="calc-grid">
          <div class="calc-input"><label>Total Volume (mL)</label><input type="number" id="ivVolume" placeholder="e.g., 1000" step="1"></div>
          <div class="calc-input"><label>Time (hours)</label><input type="number" id="ivTime" placeholder="e.g., 8" step="0.1"></div>
          <div class="calc-input">
            <label>Drop Factor (gtts/mL)</label>
            <select id="dropFactor">
              <option value="10">10 gtts/mL (Blood tubing)</option>
              <option value="15">15 gtts/mL (Standard)</option>
              <option value="20" selected>20 gtts/mL (Standard)</option>
              <option value="60">60 gtts/mL (Microdrip)</option>
            </select>
          </div>
        </div>
        <button id="calculateIVBtn" class="btn-primary" style="width:100%;">Calculate IV Rate</button>
        <div id="ivOutput"></div>
      </div>
    </div>

    <div class="card">
      <h3>üìì Quick Notes</h3>
      <textarea id="quickNotes" placeholder="Type your notes here..."></textarea>
      <div class="photo-upload-container">
        <label for="photoInput" class="photo-upload-btn">üì∑ Add Photo</label>
        <input type="file" id="photoInput" accept="image/*" multiple>
        <div class="photo-preview-container" id="photoPreviewContainer"></div>
      </div>
      <button id="saveNotesBtn" class="btn-primary" style="width:100%;margin-top:14px;">Save Notes</button>
    </div>
  </div>

  <div class="card" style="margin-bottom:28px;">
    <h3>‚úÖ Shift Checklist</h3>
    <div id="checklist" class="checklist">
      <div class="checklist-item"><input type="checkbox" id="check1"><label for="check1">Review patient charts</label></div>
      <div class="checklist-item"><input type="checkbox" id="check2"><label for="check2">Check medication orders</label></div>
      <div class="checklist-item"><input type="checkbox" id="check3"><label for="check3">Verify allergies</label></div>
      <div class="checklist-item"><input type="checkbox" id="check4"><label for="check4">Complete vital signs</label></div>
      <div class="checklist-item"><input type="checkbox" id="check5"><label for="check5">Document assessments</label></div>
      <div class="checklist-item"><input type="checkbox" id="check6"><label for="check6">Hand-off report</label></div>
    </div>
    <button id="resetChecklistBtn" style="margin-top:14px;">Reset Checklist</button>
  </div>
</div>

<script>
(function() {
  'use strict';

  const TASKS_KEY = 'nursingTasks';
  const NOTES_KEY = 'nursingNotes';
  const PHOTOS_KEY = 'nursingPhotos';
  const CHECKLIST_KEY = 'nursingChecklist';
  const TIMER_PRESET_KEY = 'timerPreset';

  let tasks = JSON.parse(localStorage.getItem(TASKS_KEY)) || [];
  let notePhotos = JSON.parse(localStorage.getItem(PHOTOS_KEY)) || [];
  let currentFilter = 'all';
  let timerSeconds = 25 * 60;
  let timerInterval = null;
  let timerPresetMinutes = 25;
  let currentDate = new Date();
  let selectedDate = null;
  let selectedMed = null;

  // ======================================================
  // ‚úÖ GRADUATION COUNTDOWN ‚Äî Fixed to December 5, 2026
  // Uses local date comparison to avoid timezone drift
  // ======================================================
  function updateGraduationCountdown() {
    var now = new Date();
    // Compare only the date portion (no time) to avoid off-by-one from timezones
    var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    var grad  = new Date(2026, 11, 5); // Month is 0-indexed: 11 = December
    var diffDays = Math.round((grad - today) / (1000 * 60 * 60 * 24));
    var el = document.getElementById('graduationCountdown');
    if (diffDays > 0) {
      el.innerText = diffDays + (diffDays === 1 ? ' Day' : ' Days');
    } else if (diffDays === 0) {
      el.innerText = 'üéâ Today is the Day!';
      showConfetti();
    } else {
      el.innerText = 'üéì Congratulations, RN!';
    }
  }

  const medications = [
    { name:"Acetaminophen (Tylenol)", class:"Analgesic, Antipyretic", indications:"Pain relief, fever reduction", dosage:"Adults: 325-650mg every 4-6 hours, Max 4000mg/day", sideEffects:["Nausea","Rash","Headache"], nursing:"Monitor for hepatotoxicity. Do not exceed max dose.", contraindications:"Severe liver disease, alcohol use" },
    { name:"Lisinopril", class:"ACE Inhibitor", indications:"Hypertension, heart failure, post-MI", dosage:"Initial: 10mg once daily, Maintenance: 20-40mg/day", sideEffects:["Dry cough","Dizziness","Hyperkalemia","Angioedema"], nursing:"Monitor BP and K+ levels. Take at same time daily.", contraindications:"Pregnancy, angioedema history" },
    { name:"Metformin", class:"Antidiabetic (Biguanide)", indications:"Type 2 Diabetes", dosage:"Initial: 500mg BID or 850mg daily, Max: 2550mg/day", sideEffects:["GI upset","Diarrhea","Lactic acidosis (rare)"], nursing:"Take with meals. Monitor renal function. Hold before contrast dye.", contraindications:"Severe renal impairment, metabolic acidosis" },
    { name:"Furosemide (Lasix)", class:"Loop Diuretic", indications:"Edema, heart failure, hypertension", dosage:"20-80mg/day PO or IV", sideEffects:["Hypokalemia","Dehydration","Hypotension","Ototoxicity"], nursing:"Monitor I&O, daily weights, electrolytes. Give in morning.", contraindications:"Anuria, severe electrolyte depletion" },
    { name:"Warfarin (Coumadin)", class:"Anticoagulant", indications:"DVT/PE prevention, A-fib, mechanical heart valves", dosage:"Variable based on INR (target 2-3)", sideEffects:["Bleeding","Bruising","Hair loss"], nursing:"Monitor INR. Avoid Vitamin K rich foods. Antidote: Vitamin K.", contraindications:"Active bleeding, pregnancy" },
    { name:"Morphine", class:"Opioid Analgesic", indications:"Moderate to severe pain, MI, pulmonary edema", dosage:"2-10mg IV/IM q2-4h PRN", sideEffects:["Respiratory depression","Constipation","Sedation","Nausea"], nursing:"Monitor respiratory rate (hold if <12). Have Naloxone available.", contraindications:"Respiratory depression, acute asthma" },
    { name:"Levothyroxine (Synthroid)", class:"Thyroid Hormone", indications:"Hypothyroidism", dosage:"25-200mcg daily, individualized", sideEffects:["Tachycardia","Weight loss","Insomnia","Heat intolerance"], nursing:"Take on empty stomach 30-60 min before breakfast. Monitor TSH.", contraindications:"Acute MI, untreated adrenal insufficiency" },
    { name:"Albuterol", class:"Beta-2 Agonist Bronchodilator", indications:"Asthma, COPD, bronchospasm", dosage:"2 puffs q4-6h PRN or 2.5mg nebulizer", sideEffects:["Tachycardia","Tremor","Nervousness","Palpitations"], nursing:"Rinse mouth after use. Monitor heart rate. Teach inhaler technique.", contraindications:"Hypersensitivity to albuterol" },
    { name:"Insulin (Regular)", class:"Antidiabetic Hormone", indications:"Type 1 & 2 Diabetes, DKA", dosage:"Variable, based on blood glucose", sideEffects:["Hypoglycemia","Weight gain","Injection site reactions"], nursing:"Monitor blood glucose. Rotate injection sites. Have glucose source ready.", contraindications:"Hypoglycemia" },
    { name:"Heparin", class:"Anticoagulant", indications:"DVT/PE treatment, prevent clotting", dosage:"IV: Weight-based protocol, SubQ: 5000 units q8-12h", sideEffects:["Bleeding","Thrombocytopenia","Bruising"], nursing:"Monitor aPTT. Antidote: Protamine sulfate. Never give IM.", contraindications:"Active bleeding, severe thrombocytopenia" },
    { name:"Aspirin", class:"Antiplatelet, NSAID", indications:"MI prevention, stroke, pain, fever", dosage:"81-325mg daily for cardio protection", sideEffects:["GI bleeding","Tinnitus","Allergic reactions"], nursing:"Take with food. Monitor for bleeding. Avoid in children with viral illness.", contraindications:"Active bleeding, children with viral infections" },
    { name:"Amoxicillin", class:"Antibiotic (Penicillin)", indications:"Bacterial infections (respiratory, ear, UTI)", dosage:"250-500mg q8h or 500-875mg q12h", sideEffects:["Diarrhea","Nausea","Rash","Allergic reactions"], nursing:"Check PCN allergy. Take full course. Monitor for C. diff.", contraindications:"Penicillin allergy" },
    { name:"Prednisone", class:"Corticosteroid", indications:"Inflammation, autoimmune disorders, asthma", dosage:"5-60mg daily", sideEffects:["Hyperglycemia","Weight gain","Mood changes","Immunosuppression"], nursing:"Take with food. Do not stop abruptly. Monitor blood glucose.", contraindications:"Systemic fungal infections" },
    { name:"Omeprazole (Prilosec)", class:"Proton Pump Inhibitor", indications:"GERD, peptic ulcer, H. pylori", dosage:"20-40mg daily before meal", sideEffects:["Headache","Diarrhea","Abdominal pain"], nursing:"Take 30-60 min before first meal. Long-term may reduce Ca/Mg.", contraindications:"Hypersensitivity to PPIs" },
    { name:"Atorvastatin (Lipitor)", class:"Statin (Lipid-lowering)", indications:"Hyperlipidemia, cardiovascular disease prevention", dosage:"10-80mg daily", sideEffects:["Muscle pain","Elevated liver enzymes","Headache"], nursing:"Monitor lipid panel and LFTs. Report muscle pain. Avoid grapefruit.", contraindications:"Active liver disease, pregnancy" }
  ];

  // CONFETTI
  const canvas = document.getElementById('confetti-canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  let pieces = [];

  function Confetti(x,y){
    this.x=x; this.y=y; this.size=Math.random()*6+4;
    this.speedY=Math.random()*3+2; this.speedX=Math.random()*2-1;
    this.color=['#2563eb','#7c3aed','#dc2626','#16a34a','#d97706'][Math.floor(Math.random()*5)];
    this.rotation=Math.random()*360; this.rotSpeed=Math.random()*10-5;
  }
  Confetti.prototype.update=function(){
    this.y+=this.speedY; this.x+=this.speedX; this.rotation+=this.rotSpeed;
    if(this.y>canvas.height){this.y=-10; this.x=Math.random()*canvas.width;}
  };
  Confetti.prototype.draw=function(){
    ctx.save(); ctx.translate(this.x,this.y); ctx.rotate(this.rotation*Math.PI/180);
    ctx.fillStyle=this.color; ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size); ctx.restore();
  };

  function animateConfetti(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pieces.forEach(p=>{p.update();p.draw();});
    if(pieces.length>0) requestAnimationFrame(animateConfetti);
  }
  function showConfetti(){
    pieces=[];
    for(let i=0;i<100;i++) pieces.push(new Confetti(Math.random()*canvas.width, Math.random()*canvas.height-canvas.height));
    animateConfetti();
    setTimeout(()=>{pieces=[];},5000);
  }

  // TASKS
  function saveTasks(){ localStorage.setItem(TASKS_KEY,JSON.stringify(tasks)); }

  function addTask(){
    var text=document.getElementById('taskInput').value.trim();
    var subject=document.getElementById('taskSubject').value;
    var priority=document.getElementById('taskPriority').value;
    var date=document.getElementById('taskDate').value;
    if(!text||!date){alert('Please enter task description and date');return;}
    tasks.push({text,subject,priority,date,done:false,id:Date.now()});
    saveTasks(); render(); renderCalendar();
    document.getElementById('taskInput').value='';
    document.getElementById('taskDate').valueAsDate=new Date();
  }

  function toggleTask(i){tasks[i].done=!tasks[i].done; saveTasks(); render(); if(tasks[i].done)showConfetti();}
  function removeTask(i){if(confirm('Delete this task?')){tasks.splice(i,1); saveTasks(); render(); renderCalendar();}}

  function filterTasks(f){
    currentFilter=f;
    document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));
    document.querySelector('.filter-tab[data-filter="'+f+'"]').classList.add('active');
    render();
  }

  function getFilteredTasks(){
    var now=new Date(), today=now.toISOString().split('T')[0];
    var wk=new Date(now.getTime()+7*864e5).toISOString().split('T')[0];
    if(currentFilter==='today') return tasks.filter(t=>t.date===today);
    if(currentFilter==='week') return tasks.filter(t=>t.date>=today&&t.date<=wk);
    return tasks;
  }

  function formatDate(ds){
    var p=ds.split('-');
    return new Date(+p[0],+p[1]-1,+p[2]).toLocaleDateString('en-US',{month:'short',day:'numeric'});
  }

  function render(){
    var ft=getFilteredTasks(), c=document.getElementById('taskList');
    if(!ft.length){c.innerHTML='<div class="empty-state">No tasks yet</div>';updateStats();return;}
    c.innerHTML=ft.map(task=>{
      var oi=tasks.indexOf(task);
      return `<div class="task-item ${task.done?'done':''} priority-${task.priority}">
        <div class="task-checkbox ${task.done?'checked':''}" data-action="toggle" data-index="${oi}">${task.done?'‚úì':''}</div>
        <div class="task-content">
          <div class="task-text">${task.text}</div>
          <div class="task-meta"><span>${task.subject}</span><span>${task.priority.toUpperCase()}</span><span>${formatDate(task.date)}</span></div>
        </div>
        <div class="task-actions"><button data-action="remove" data-index="${oi}">üóëÔ∏è</button></div>
      </div>`;
    }).join('');
    updateStats();
  }

  function updateStats(){
    var now=new Date(), today=now.toISOString().split('T')[0];
    var wk=new Date(now.getTime()+7*864e5).toISOString().split('T')[0];
    document.getElementById('weekTaskCount').innerText=tasks.filter(t=>t.date>=today&&t.date<=wk).length;
    document.getElementById('completedCount').innerText=tasks.filter(t=>t.date===today&&t.done).length;
  }

  // TIMER
  function updateTimerDisplay(){
    var m=Math.floor(timerSeconds/60),s=timerSeconds%60;
    document.getElementById('timerDisplay').innerText=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
  }
  function startTimer(){
    if(timerInterval) return;
    timerInterval=setInterval(()=>{
      if(timerSeconds>0){timerSeconds--;updateTimerDisplay();}
      else{pauseTimer();alert('‚è∞ Timer finished! Great work!');showConfetti();}
    },1000);
  }
  function pauseTimer(){if(timerInterval){clearInterval(timerInterval);timerInterval=null;}}
  function setTimerPreset(min,btn){
    pauseTimer(); timerPresetMinutes=min; timerSeconds=min*60; updateTimerDisplay();
    localStorage.setItem(TIMER_PRESET_KEY,min);
    document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
  }
  function setCustomTimer(){
    var min=parseInt(document.getElementById('customMinutes').value);
    if(min&&min>0&&min<=180){
      pauseTimer(); timerPresetMinutes=min; timerSeconds=min*60; updateTimerDisplay();
      localStorage.setItem(TIMER_PRESET_KEY,min);
      document.getElementById('customMinutes').value='';
      document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active'));
    }
  }
  function resetTimer(){pauseTimer(); timerSeconds=timerPresetMinutes*60; updateTimerDisplay();}

  // CALCULATORS
  function calculate(){
    var o=parseFloat(document.getElementById('ordered').value);
    var a=parseFloat(document.getElementById('available').value);
    var v=parseFloat(document.getElementById('volume').value);
    if(!o||!a||!v){document.getElementById('doseOutput').innerHTML='<div class="calc-result" style="background:rgba(220,38,38,0.1);color:var(--danger);">Please fill in all fields</div>';return;}
    document.getElementById('doseOutput').innerHTML='<div class="calc-result">üíâ Administer '+((o/a)*v).toFixed(2)+' mL</div>';
  }
  function calculateIV(){
    var vol=parseFloat(document.getElementById('ivVolume').value);
    var time=parseFloat(document.getElementById('ivTime').value);
    var df=parseFloat(document.getElementById('dropFactor').value);
    if(!vol||!time||!df){document.getElementById('ivOutput').innerHTML='<div class="calc-result" style="background:rgba(220,38,38,0.1);color:var(--danger);">Please fill in all fields</div>';return;}
    document.getElementById('ivOutput').innerHTML='<div class="calc-result">üíß Flow Rate: '+(vol/time).toFixed(1)+' mL/hr<br>'+((vol*df)/(time*60)).toFixed(0)+' gtts/min</div>';
  }

  // MEDICATIONS
  function searchMedications(){
    var q=document.getElementById('medSearch').value.toLowerCase().trim();
    var r=document.getElementById('medResults');
    if(!q){r.innerHTML='<div class="empty-state">Start typing to search medications</div>';selectedMed=null;return;}
    var filtered=medications.filter(m=>m.name.toLowerCase().includes(q)||m.class.toLowerCase().includes(q));
    if(!filtered.length){r.innerHTML='<div class="empty-state">No medications found</div>';selectedMed=null;return;}
    if(selectedMed){
      var m=selectedMed;
      r.innerHTML='<button onclick="clearMedSelection()" style="margin-bottom:14px;">‚Üê Back to results</button>'+
        '<div class="med-detail">'+
        '<div class="med-name" style="font-size:20px;margin-bottom:10px;">'+m.name+'</div>'+
        '<div class="med-class" style="margin-bottom:16px;">'+m.class+'</div>'+
        '<h4>Indications</h4><p>'+m.indications+'</p>'+
        '<h4>Dosage</h4><p>'+m.dosage+'</p>'+
        '<h4>Side Effects</h4><ul>'+m.sideEffects.map(s=>'<li>'+s+'</li>').join('')+'</ul>'+
        '<h4>Nursing Considerations</h4><p>'+m.nursing+'</p>'+
        '<h4>Contraindications</h4><p>'+m.contraindications+'</p></div>';
    } else {
      r.innerHTML=filtered.map(m=>'<div class="med-item" onclick="showMedDetail('+medications.indexOf(m)+')"><div class="med-name">'+m.name+'</div><div class="med-class">'+m.class+'</div></div>').join('');
    }
  }
  window.showMedDetail=i=>{selectedMed=medications[i];searchMedications();};
  window.clearMedSelection=()=>{selectedMed=null;searchMedications();};

  // PHOTOS
  function savePhotos(){localStorage.setItem(PHOTOS_KEY,JSON.stringify(notePhotos));}
  function renderPhotos(){
    document.getElementById('photoPreviewContainer').innerHTML=notePhotos.map((p,i)=>
      `<div class="photo-preview"><img src="${p}" alt="Note photo"><button class="photo-delete" onclick="deletePhoto(${i})">√ó</button></div>`
    ).join('');
  }
  window.deletePhoto=i=>{if(confirm('Delete this photo?')){notePhotos.splice(i,1);savePhotos();renderPhotos();}};

  // NOTES
  function saveNotes(){localStorage.setItem(NOTES_KEY,document.getElementById('quickNotes').value);savePhotos();alert('‚úì Notes saved!');}
  function loadNotes(){document.getElementById('quickNotes').value=localStorage.getItem(NOTES_KEY)||'';}

  // CHECKLIST
  function saveChecklist(){
    var states=Array.from(document.querySelectorAll('.checklist input[type="checkbox"]')).map(cb=>cb.checked);
    localStorage.setItem(CHECKLIST_KEY,JSON.stringify(states));
  }
  function loadChecklist(){
    var saved=localStorage.getItem(CHECKLIST_KEY);
    if(saved){var s=JSON.parse(saved); document.querySelectorAll('.checklist input[type="checkbox"]').forEach((cb,i)=>cb.checked=s[i]||false);}
  }
  function resetChecklist(){document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb=>cb.checked=false);saveChecklist();}

  // THEME
  function toggleTheme(){
    document.body.classList.toggle('dark');
    var dark=document.body.classList.contains('dark');
    localStorage.setItem('theme',dark?'dark':'light');
    document.getElementById('themeBtn').innerText=dark?'‚òÄÔ∏è':'üåô';
  }
  function loadTheme(){
    if(localStorage.getItem('theme')==='dark'){document.body.classList.add('dark');document.getElementById('themeBtn').innerText='‚òÄÔ∏è';}
  }

  // TABS
  function switchTab(name){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
    document.querySelector('.tab[data-tab="'+name+'"]').classList.add('active');
    document.getElementById(name+'Tab').classList.add('active');
  }

  // CALENDAR
  function renderCalendar(){
    var yr=currentDate.getFullYear(), mo=currentDate.getMonth();
    var months=['January','February','March','April','May','June','July','August','September','October','November','December'];
    document.getElementById('calendarMonth').innerText=months[mo]+' '+yr;
    var firstDay=new Date(yr,mo,1).getDay();
    var daysInMonth=new Date(yr,mo+1,0).getDate();
    var prevDays=new Date(yr,mo,0).getDate();
    var cal=document.getElementById('calendar');
    cal.innerHTML=''; cal.className='calendar-grid';
    ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d=>{
      var h=document.createElement('div'); h.className='calendar-day-header'; h.innerText=d; cal.appendChild(h);
    });
    var todayStr=new Date().toISOString().split('T')[0];
    for(var i=firstDay-1;i>=0;i--){
      var d=document.createElement('div'); d.className='calendar-day other-month';
      d.innerHTML='<div class="calendar-day-number">'+(prevDays-i)+'</div>'; cal.appendChild(d);
    }
    for(var day=1;day<=daysInMonth;day++){
      var el=document.createElement('div'); el.className='calendar-day';
      var ds=yr+'-'+String(mo+1).padStart(2,'0')+'-'+String(day).padStart(2,'0');
      if(ds===todayStr) el.classList.add('today');
      if(tasks.some(t=>t.date===ds)) el.classList.add('has-tasks');
      if(selectedDate===ds) el.classList.add('selected');
      el.innerHTML='<div class="calendar-day-number">'+day+'</div>';
      el.dataset.date=ds; cal.appendChild(el);
    }
    var total=cal.children.length-7;
    for(var r=1;r<=42-total-7;r++){
      var re=document.createElement('div'); re.className='calendar-day other-month';
      re.innerHTML='<div class="calendar-day-number">'+r+'</div>'; cal.appendChild(re);
    }
  }

  function selectDate(ds){selectedDate=ds; renderCalendar(); showDayEvents(ds);}

  function showDayEvents(ds){
    var c=document.getElementById('dayEvents');
    var dt=tasks.filter(t=>t.date===ds);
    if(!dt.length){c.innerHTML='<div style="text-align:center;color:var(--muted);padding:20px;">No tasks for '+formatDate(ds)+'</div>';return;}
    var p=ds.split('-'), date=new Date(+p[0],+p[1]-1,+p[2]);
    c.innerHTML='<h3 style="margin-bottom:12px;font-size:16px;">Tasks for '+date.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'})+'</h3>';
    dt.forEach(task=>{
      var div=document.createElement('div'); div.className='event-item priority-'+task.priority;
      div.innerHTML='<div style="display:flex;justify-content:space-between;align-items:center;"><div><div style="font-weight:600;margin-bottom:4px;">'+task.text+'</div><div style="font-size:12px;color:var(--muted);">'+task.subject+' ¬∑ '+task.priority.toUpperCase()+'</div></div>'+(task.done?'<span style="color:var(--success);font-size:20px;">‚úì</span>':'')+'</div>';
      c.appendChild(div);
    });
  }

  // EVENT LISTENERS
  document.getElementById('themeBtn').addEventListener('click',toggleTheme);
  document.getElementById('addTaskBtn').addEventListener('click',addTask);
  document.getElementById('startTimerBtn').addEventListener('click',startTimer);
  document.getElementById('pauseTimerBtn').addEventListener('click',pauseTimer);
  document.getElementById('resetTimerBtn').addEventListener('click',resetTimer);
  document.getElementById('setCustomTimerBtn').addEventListener('click',setCustomTimer);
  document.getElementById('calculateBtn').addEventListener('click',calculate);
  document.getElementById('calculateIVBtn').addEventListener('click',calculateIV);
  document.getElementById('saveNotesBtn').addEventListener('click',saveNotes);
  document.getElementById('resetChecklistBtn').addEventListener('click',resetChecklist);
  document.getElementById('prevMonthBtn').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()-1);renderCalendar();if(selectedDate)showDayEvents(selectedDate);});
  document.getElementById('nextMonthBtn').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()+1);renderCalendar();if(selectedDate)showDayEvents(selectedDate);});
  document.getElementById('medSearch').addEventListener('input',searchMedications);
  document.getElementById('photoInput').addEventListener('change',function(e){
    Array.from(e.target.files).forEach(file=>{
      var r=new FileReader();
      r.onload=ev=>{notePhotos.push(ev.target.result);renderPhotos();};
      r.readAsDataURL(file);
    });
    e.target.value='';
  });
  document.querySelectorAll('.filter-tab').forEach(tab=>tab.addEventListener('click',function(){filterTasks(this.dataset.filter);}));
  document.querySelectorAll('.tab').forEach(tab=>tab.addEventListener('click',function(){switchTab(this.dataset.tab);}));
  document.querySelectorAll('.preset-btn').forEach(btn=>btn.addEventListener('click',function(){setTimerPreset(parseInt(this.dataset.minutes),this);}));
  document.getElementById('taskList').addEventListener('click',function(e){
    var btn=e.target.closest('[data-action]');
    if(btn){var a=btn.dataset.action,i=parseInt(btn.dataset.index);if(a==='toggle')toggleTask(i);else if(a==='remove')removeTask(i);}
  });
  document.getElementById('calendar').addEventListener('click',function(e){
    var d=e.target.closest('.calendar-day');
    if(d&&d.dataset.date&&!d.classList.contains('other-month'))selectDate(d.dataset.date);
  });
  document.getElementById('checklist').addEventListener('change',saveChecklist);
  window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});

  // INIT
  loadTheme(); loadNotes(); renderPhotos(); loadChecklist();
  render(); renderCalendar(); updateTimerDisplay(); searchMedications();
  updateGraduationCountdown();
  setInterval(updateGraduationCountdown, 60000);

  var sp=localStorage.getItem(TIMER_PRESET_KEY);
  if(sp){
    timerPresetMinutes=parseInt(sp); timerSeconds=timerPresetMinutes*60; updateTimerDisplay();
    document.querySelectorAll('.preset-btn').forEach(b=>{if(parseInt(b.dataset.minutes)===timerPresetMinutes)b.classList.add('active');});
  }
  document.getElementById('taskDate').valueAsDate=new Date();
})();
</script>
</body>
</html>
