<!DOCTYPE html>
<html lang="en">
<head>
  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Nursing Productivity">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23dc2626' width='100' height='100' rx='20'/><text x='50' y='65' font-size='45' font-weight='bold' fill='white' text-anchor='middle' font-family='system-ui'>KJ</text></svg>">
<title>Nursing Productivity System ‚Äì Kalicia Szabo</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg:#f8fafc;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --accent:#2563eb;
  --accent-light:#dbeafe;
  --success:#16a34a;
  --warning:#d97706;
  --danger:#dc2626;
  --border:#e5e7eb;
  --shadow:0 2px 4px rgba(0,0,0,0.08);
  --shadow-lg:0 12px 32px rgba(0,0,0,0.12);
}
.dark {
  --bg:#020617;
  --card:#0f172a;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent-light:#1e3a8a;
  --border:#1e293b;
  --shadow:0 2px 4px rgba(0,0,0,0.4);
  --shadow-lg:0 12px 32px rgba(0,0,0,0.5);
}

* { 
  box-sizing:border-box; 
  margin:0;
  padding:0;
  -webkit-tap-highlight-color: transparent;
}

body {
  background:var(--bg);
  background-image: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=2070&auto=format&fit=crop');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  background-repeat: no-repeat;
  color:var(--text);
  font-family:'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height:1.6;
  transition:background 0.3s ease;
  position: relative;
  touch-action: pan-y;
  -webkit-user-select: none;
  user-select: none;
  overflow-x: hidden;
}

input, textarea {
  -webkit-user-select: text;
  user-select: text;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(248, 250, 252, 0.85);
  z-index: -1;
  transition: background 0.3s ease;
}

body.dark::before {
  background: rgba(2, 6, 23, 0.92);
}

body.dark {
  background-image: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=2070&auto=format&fit=crop');
}

.container {
  max-width: 1024px;
  margin: auto;
  padding: 24px;
}

#confetti-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 9999;
}

header {
  background:rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border:1px solid var(--border);
  border-radius:20px;
  padding:28px;
  margin-bottom:28px;
  box-shadow:var(--shadow-lg);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:20px;
}

.dark header {
  background:rgba(15, 23, 42, 0.95);
}

.header-left {
  display:flex;
  align-items:center;
  gap:20px;
  flex:1;
}

.logo-container {
  width:90px;
  height:90px;
  background:linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:var(--shadow-lg);
  flex-shrink:0;
}

.logo-text {
  color:white;
  font-weight:700;
  font-size:36px;
  letter-spacing:-1px;
}

.header-info h1 { 
  font-family: 'Playfair Display', serif;
  font-size:38px;
  font-weight:900;
  margin-bottom:6px;
  background:linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  letter-spacing:-0.5px;
}

.header-info .subtitle { 
  color:var(--muted); 
  font-size:15px;
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
}

.badge {
  background:var(--accent-light);
  color:var(--accent);
  padding:6px 12px;
  border-radius:8px;
  font-size:13px;
  font-weight:600;
}

button {
  padding:14px 22px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  cursor:pointer;
  font-weight:500;
  transition:all 0.2s;
  box-shadow:var(--shadow);
  font-size:16px;
  min-height:48px;
  min-width:48px;
  touch-action: manipulation;
}

button:active {
  transform:scale(0.96);
  background:var(--accent-light);
}

.btn-primary {
  background:var(--accent);
  color:white;
  border-color:var(--accent);
}

.btn-primary:active {
  background:#1d4ed8;
}

/* iPad-optimized two-column layout */
.ipad-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-bottom: 28px;
}

.ipad-grid-full {
  grid-column: 1 / -1;
}

.grid {
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:20px;
  margin-bottom:28px;
}

.card {
  background:rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border:1px solid var(--border);
  border-radius:20px;
  padding:24px;
  box-shadow:var(--shadow);
  transition:transform 0.2s, box-shadow 0.2s;
}

.dark .card {
  background:rgba(15, 23, 42, 0.95);
}

.card h3 {
  font-size:14px;
  font-weight:600;
  color:var(--muted);
  text-transform:uppercase;
  letter-spacing:0.5px;
  margin-bottom:14px;
}

.stat {
  font-size:40px;
  font-weight:700;
  background:linear-gradient(135deg, var(--accent) 0%, #7c3aed 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

.stat-label {
  color:var(--muted);
  font-size:13px;
  margin-top:6px;
}

.graduation-card {
  background: linear-gradient(135deg, #7c3aed 0%, #2563eb 100%);
  color: white;
  padding:28px;
  border-radius:20px;
  box-shadow:var(--shadow-lg);
  margin-bottom:28px;
  position: relative;
  overflow: hidden;
}

.graduation-card::before {
  content: 'üéì';
  position: absolute;
  top: -20px;
  right: -20px;
  font-size: 120px;
  opacity: 0.15;
}

.graduation-card h2 {
  font-family: 'Playfair Display', serif;
  font-size:32px;
  font-weight:900;
  margin-bottom:12px;
  position: relative;
}

.graduation-card .countdown {
  font-size:52px;
  font-weight:700;
  margin:16px 0;
  position: relative;
}

.graduation-card .subtitle {
  font-size:16px;
  opacity:0.9;
  position: relative;
}

.filter-tabs {
  display:flex;
  gap:10px;
  margin-bottom:20px;
  flex-wrap:wrap;
}

.filter-tab {
  padding:10px 18px;
  border-radius:10px;
  background:var(--card);
  border:1px solid var(--border);
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition:all 0.2s;
  min-height:44px;
}

.filter-tab.active {
  background:var(--accent);
  color:white;
  border-color:var(--accent);
}

.filter-tab:active {
  transform:scale(0.95);
}

.task-form {
  display:flex;
  flex-direction:column;
  gap:14px;
  margin-bottom:20px;
}

.task-form input, .task-form select {
  padding:14px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  font-size:15px;
  font-family:inherit;
}

.task-form input:focus, .task-form select:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-light);
}

.task-item {
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:16px;
  margin-bottom:12px;
  display:flex;
  align-items:center;
  gap:14px;
  transition:all 0.2s;
}

.task-item:active {
  transform:scale(0.98);
}

.task-item.done {
  opacity:0.6;
}

.task-item.done .task-text {
  text-decoration:line-through;
}

.task-checkbox {
  width:28px;
  height:28px;
  border-radius:50%;
  border:2px solid var(--border);
  cursor:pointer;
  flex-shrink:0;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all 0.2s;
  min-width:28px;
  min-height:28px;
}

.task-checkbox.checked {
  background:var(--success);
  border-color:var(--success);
  color:white;
}

.task-content {
  flex:1;
}

.task-text {
  font-weight:500;
  font-size:15px;
  margin-bottom:4px;
}

.task-meta {
  display:flex;
  gap:10px;
  font-size:12px;
  color:var(--muted);
  flex-wrap:wrap;
}

.priority-high { border-left:4px solid var(--danger); }
.priority-medium { border-left:4px solid var(--warning); }
.priority-low { border-left:4px solid var(--accent); }

.task-actions {
  display:flex;
  gap:8px;
}

.task-actions button {
  padding:8px 12px;
  min-width:auto;
  min-height:36px;
  font-size:14px;
}

.timer-display {
  font-size:64px;
  font-weight:700;
  text-align:center;
  margin:24px 0;
  font-variant-numeric:tabular-nums;
  background:linear-gradient(135deg, var(--accent) 0%, #7c3aed 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

.timer-controls {
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
  margin-bottom:20px;
}

.timer-presets {
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
  margin-bottom:20px;
}

.preset-btn {
  padding:12px;
  font-size:14px;
}

.preset-btn.active {
  background:var(--accent);
  color:white;
  border-color:var(--accent);
}

.custom-timer {
  display:flex;
  gap:10px;
  align-items:center;
  margin-bottom:20px;
}

.custom-timer input {
  flex:1;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  font-size:15px;
}

.custom-timer input:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-light);
}

.calc-grid {
  display:grid;
  gap:14px;
  margin-bottom:20px;
}

.calc-input {
  display:flex;
  flex-direction:column;
  gap:8px;
}

.calc-input label {
  font-size:13px;
  font-weight:600;
  color:var(--muted);
}

.calc-input input {
  padding:14px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  font-size:15px;
}

.calc-input input:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-light);
}

.calc-result {
  background:var(--accent-light);
  color:var(--accent);
  padding:18px;
  border-radius:12px;
  text-align:center;
  font-size:18px;
  font-weight:600;
  margin-top:14px;
}

textarea {
  width:100%;
  padding:14px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  font-size:15px;
  font-family:inherit;
  resize:vertical;
  min-height:180px;
}

textarea:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 3px var(--accent-light);
}

.checklist {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.checklist-item {
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  transition:all 0.2s;
}

.checklist-item:active {
  transform:scale(0.98);
}

.checklist-item input[type="checkbox"] {
  width:24px;
  height:24px;
  cursor:pointer;
  min-width:24px;
  min-height:24px;
}

.checklist-item label {
  flex:1;
  cursor:pointer;
  font-size:15px;
}

.calendar-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

.calendar-header h3 {
  font-size:20px;
  font-weight:700;
  text-transform:none;
}

.calendar-nav {
  display:flex;
  gap:10px;
}

.calendar-grid {
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
}

.calendar-day-header {
  text-align:center;
  font-size:12px;
  font-weight:600;
  color:var(--muted);
  padding:10px;
}

.calendar-day {
  aspect-ratio:1;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
  cursor:pointer;
  transition:all 0.2s;
  position:relative;
  background:var(--card);
  border:1px solid var(--border);
  min-height:52px;
}

.calendar-day:active {
  transform:scale(0.95);
}

.calendar-day.today {
  background:var(--accent-light);
  border-color:var(--accent);
  font-weight:600;
}

.calendar-day.selected {
  background:var(--accent);
  color:white;
  border-color:var(--accent);
}

.calendar-day.has-tasks::after {
  content:'';
  position:absolute;
  bottom:6px;
  width:6px;
  height:6px;
  background:var(--accent);
  border-radius:50%;
}

.calendar-day.selected.has-tasks::after {
  background:white;
}

.calendar-day.other-month {
  opacity:0.3;
  cursor:default;
}

.calendar-day-number {
  font-size:15px;
  font-weight:500;
}

.event-item {
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:14px;
  margin-bottom:10px;
}

.event-item.priority-high { border-left:4px solid var(--danger); }
.event-item.priority-medium { border-left:4px solid var(--warning); }
.event-item.priority-low { border-left:4px solid var(--accent); }

#dayEvents {
  margin-top:20px;
  padding:20px;
  background:rgba(255, 255, 255, 0.5);
  border-radius:12px;
  min-height:120px;
}

.dark #dayEvents {
  background:rgba(15, 23, 42, 0.5);
}

.empty-state {
  text-align:center;
  color:var(--muted);
  padding:40px 20px;
  font-size:15px;
}

.empty-state::before {
  content:'üìã';
  display:block;
  font-size:48px;
  margin-bottom:12px;
}

/* Improved touch targets for iPad */
@media (hover: none) and (pointer: coarse) {
  button {
    min-height:52px;
  }
  
  .filter-tab {
    min-height:48px;
  }
  
  .task-checkbox {
    width:32px;
    height:32px;
    min-width:32px;
    min-height:32px;
  }
}
</style>
</head>

<body>
<canvas id="confetti-canvas"></canvas>

<div class="container">
  <header>
    <div class="header-left">
      <div class="logo-container">
        <div class="logo-text">KJ</div>
      </div>
      <div class="header-info">
        <h1>Kalicia Szabo</h1>
        <div class="subtitle">
          <span>Nursing Student</span>
          <span class="badge">ADN Program</span>
        </div>
      </div>
    </div>
    <button id="themeBtn">üåô</button>
  </header>

  <div class="graduation-card">
    <h2>üéì Graduation Countdown</h2>
    <div class="countdown" id="graduationCountdown">Loading...</div>
    <div class="subtitle">Days until you become a Registered Nurse!</div>
  </div>

  <div class="grid">
    <div class="card">
      <h3>Tasks This Week</h3>
      <div class="stat" id="weekTaskCount">0</div>
      <div class="stat-label">Total tasks</div>
    </div>
    <div class="card">
      <h3>Completed Today</h3>
      <div class="stat" id="completedCount">0</div>
      <div class="stat-label">Tasks done</div>
    </div>
  </div>

  <div class="ipad-grid">
    <!-- Left Column: Tasks & Timer -->
    <div>
      <div class="card">
        <h3>üìù Task Manager</h3>
        <div class="filter-tabs">
          <div class="filter-tab active" data-filter="all">All</div>
          <div class="filter-tab" data-filter="today">Today</div>
          <div class="filter-tab" data-filter="week">Week</div>
        </div>
        <div class="task-form">
          <input type="text" id="taskInput" placeholder="Enter task description...">
          <select id="taskSubject">
            <option value="Pharmacology">Pharmacology</option>
            <option value="Med-Surg">Med-Surg</option>
            <option value="Fundamentals">Fundamentals</option>
            <option value="Mental Health">Mental Health</option>
            <option value="Pediatrics">Pediatrics</option>
            <option value="OB/GYN">OB/GYN</option>
            <option value="Clinical">Clinical</option>
            <option value="Study">Study</option>
            <option value="Personal">Personal</option>
          </select>
          <select id="taskPriority">
            <option value="high">High Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="low">Low Priority</option>
          </select>
          <input type="date" id="taskDate">
          <button id="addTaskBtn" class="btn-primary">Add Task</button>
        </div>
        <div id="taskList"></div>
      </div>

      <div class="card" style="margin-top:24px;">
        <h3>‚è±Ô∏è Pomodoro Timer</h3>
        <div class="timer-presets">
          <button class="preset-btn active" data-minutes="25">25 min</button>
          <button class="preset-btn" data-minutes="15">15 min</button>
          <button class="preset-btn" data-minutes="45">45 min</button>
          <button class="preset-btn" data-minutes="60">60 min</button>
        </div>
        <div class="custom-timer">
          <input type="number" id="customMinutes" placeholder="Custom minutes" min="1" max="180">
          <button id="setCustomTimerBtn">Set</button>
        </div>
        <div class="timer-display" id="timerDisplay">25:00</div>
        <div class="timer-controls">
          <button id="startTimerBtn" class="btn-primary">Start</button>
          <button id="pauseTimerBtn">Pause</button>
          <button id="resetTimerBtn">Reset</button>
        </div>
      </div>
    </div>

    <!-- Right Column: Calendar & Tools -->
    <div>
      <div class="card">
        <div class="calendar-header">
          <button id="prevMonthBtn">‚Üê</button>
          <h3 id="calendarMonth">Month Year</h3>
          <button id="nextMonthBtn">‚Üí</button>
        </div>
        <div id="calendar" class="calendar-grid"></div>
        <div id="dayEvents"></div>
      </div>

      <div class="card" style="margin-top:24px;">
        <h3>üíâ Dosage Calculator</h3>
        <div class="calc-grid">
          <div class="calc-input">
            <label>Ordered Dose (mg)</label>
            <input type="number" id="ordered" placeholder="e.g., 500" step="0.01">
          </div>
          <div class="calc-input">
            <label>Available Strength (mg)</label>
            <input type="number" id="available" placeholder="e.g., 250" step="0.01">
          </div>
          <div class="calc-input">
            <label>Available Volume (mL)</label>
            <input type="number" id="volume" placeholder="e.g., 5" step="0.01">
          </div>
        </div>
        <button id="calculateBtn" class="btn-primary" style="width:100%;">Calculate Dose</button>
        <div id="doseOutput"></div>
      </div>
    </div>
  </div>

  <div class="ipad-grid">
    <div class="card">
      <h3>üìì Quick Notes</h3>
      <textarea id="quickNotes" placeholder="Type your notes here..."></textarea>
      <button id="saveNotesBtn" class="btn-primary" style="width:100%; margin-top:14px;">Save Notes</button>
    </div>

    <div class="card">
      <h3>‚úÖ Shift Checklist</h3>
      <div id="checklist" class="checklist">
        <div class="checklist-item">
          <input type="checkbox" id="check1">
          <label for="check1">Review patient charts</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check2">
          <label for="check2">Check medication orders</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check3">
          <label for="check3">Verify allergies</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check4">
          <label for="check4">Complete vital signs</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check5">
          <label for="check5">Document assessments</label>
        </div>
        <div class="checklist-item">
          <input type="checkbox" id="check6">
          <label for="check6">Hand-off report</label>
        </div>
      </div>
      <button id="resetChecklistBtn" style="width:100%; margin-top:14px;">Reset Checklist</button>
    </div>
  </div>
</div>

<script>
(function() {
  'use strict';

  // CONSTANTS
  const TASKS_KEY = 'nursingTasks';
  const NOTES_KEY = 'nursingNotes';
  const CHECKLIST_KEY = 'nursingChecklist';
  const TIMER_PRESET_KEY = 'timerPreset';
  const GRADUATION_DATE = new Date('2025-05-15');

  // STATE
  let tasks = JSON.parse(localStorage.getItem(TASKS_KEY)) || [];
  let currentFilter = 'all';
  let timerSeconds = 25 * 60;
  let timerInterval = null;
  let timerPresetMinutes = 25;
  let currentDate = new Date();
  let selectedDate = null;
  let graduationCountdownInterval = null;

  // CONFETTI
  const canvas = document.getElementById('confetti-canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  let confettiPieces = [];

  function Confetti(x, y) {
    this.x = x;
    this.y = y;
    this.size = Math.random() * 6 + 4;
    this.speedY = Math.random() * 3 + 2;
    this.speedX = Math.random() * 2 - 1;
    this.color = ['#2563eb', '#7c3aed', '#dc2626', '#16a34a', '#d97706'][Math.floor(Math.random() * 5)];
    this.rotation = Math.random() * 360;
    this.rotationSpeed = Math.random() * 10 - 5;
  }

  Confetti.prototype.update = function() {
    this.y += this.speedY;
    this.x += this.speedX;
    this.rotation += this.rotationSpeed;
    if (this.y > canvas.height) {
      this.y = -10;
      this.x = Math.random() * canvas.width;
    }
  };

  Confetti.prototype.draw = function() {
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.rotate(this.rotation * Math.PI / 180);
    ctx.fillStyle = this.color;
    ctx.fillRect(-this.size / 2, -this.size / 2, this.size, this.size);
    ctx.restore();
  };

  function createConfetti() {
    confettiPieces = [];
    for (let i = 0; i < 100; i++) {
      confettiPieces.push(new Confetti(Math.random() * canvas.width, Math.random() * canvas.height - canvas.height));
    }
  }

  function animateConfetti() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    confettiPieces.forEach(function(piece) {
      piece.update();
      piece.draw();
    });
    requestAnimationFrame(animateConfetti);
  }

  function showConfetti() {
    createConfetti();
    animateConfetti();
    setTimeout(function() {
      confettiPieces = [];
    }, 5000);
  }

  // GRADUATION COUNTDOWN
  function updateGraduationCountdown() {
    const now = new Date();
    const diff = GRADUATION_DATE - now;
    const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
    document.getElementById('graduationCountdown').innerText = days + ' Days';
  }

  // TASKS
  function saveTasks() {
    localStorage.setItem(TASKS_KEY, JSON.stringify(tasks));
  }

  function addTask() {
    const text = document.getElementById('taskInput').value.trim();
    const subject = document.getElementById('taskSubject').value;
    const priority = document.getElementById('taskPriority').value;
    const date = document.getElementById('taskDate').value;

    if (!text || !date) {
      alert('Please enter task description and date');
      return;
    }

    tasks.push({
      text: text,
      subject: subject,
      priority: priority,
      date: date,
      done: false,
      id: Date.now()
    });

    saveTasks();
    render();
    renderCalendar();

    document.getElementById('taskInput').value = '';
    document.getElementById('taskDate').valueAsDate = new Date();
  }

  function toggleTask(index) {
    tasks[index].done = !tasks[index].done;
    saveTasks();
    render();
    
    if (tasks[index].done) {
      showConfetti();
    }
  }

  function removeTask(index) {
    if (confirm('Delete this task?')) {
      tasks.splice(index, 1);
      saveTasks();
      render();
      renderCalendar();
    }
  }

  function filterTasks(filter) {
    currentFilter = filter;
    document.querySelectorAll('.filter-tab').forEach(function(tab) {
      tab.classList.remove('active');
    });
    document.querySelector('.filter-tab[data-filter="' + filter + '"]').classList.add('active');
    render();
  }

  function getFilteredTasks() {
    const now = new Date();
    const today = now.toISOString().split('T')[0];
    const weekFromNow = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];

    if (currentFilter === 'today') {
      return tasks.filter(function(t) { return t.date === today; });
    } else if (currentFilter === 'week') {
      return tasks.filter(function(t) { return t.date >= today && t.date <= weekFromNow; });
    }
    return tasks;
  }

  function formatDate(dateStr) {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
  }

  function render() {
    const filteredTasks = getFilteredTasks();
    const container = document.getElementById('taskList');

    if (filteredTasks.length === 0) {
      container.innerHTML = '<div class="empty-state">No tasks yet</div>';
    } else {
      container.innerHTML = filteredTasks.map(function(task, index) {
        const originalIndex = tasks.indexOf(task);
        return '<div class="task-item ' + (task.done ? 'done' : '') + ' priority-' + task.priority + '">' +
          '<div class="task-checkbox ' + (task.done ? 'checked' : '') + '" data-action="toggle" data-index="' + originalIndex + '">' +
            (task.done ? '‚úì' : '') +
          '</div>' +
          '<div class="task-content">' +
            '<div class="task-text">' + task.text + '</div>' +
            '<div class="task-meta">' +
              '<span>' + task.subject + '</span>' +
              '<span>' + task.priority.toUpperCase() + '</span>' +
              '<span>' + formatDate(task.date) + '</span>' +
            '</div>' +
          '</div>' +
          '<div class="task-actions">' +
            '<button data-action="remove" data-index="' + originalIndex + '">üóëÔ∏è</button>' +
          '</div>' +
        '</div>';
      }).join('');
    }

    updateStats();
  }

  function updateStats() {
    const now = new Date();
    const today = now.toISOString().split('T')[0];
    const weekFromNow = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];

    const weekTasks = tasks.filter(function(t) { 
      return t.date >= today && t.date <= weekFromNow; 
    });
    const completedToday = tasks.filter(function(t) { 
      return t.date === today && t.done; 
    });

    document.getElementById('weekTaskCount').innerText = weekTasks.length;
    document.getElementById('completedCount').innerText = completedToday.length;
  }

  // TIMER
  function updateTimerDisplay() {
    const minutes = Math.floor(timerSeconds / 60);
    const seconds = timerSeconds % 60;
    document.getElementById('timerDisplay').innerText = 
      String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
  }

  function startTimer() {
    if (timerInterval) return;
    
    timerInterval = setInterval(function() {
      if (timerSeconds > 0) {
        timerSeconds--;
        updateTimerDisplay();
      } else {
        pauseTimer();
        alert('‚è∞ Timer finished! Great work!');
        showConfetti();
      }
    }, 1000);
  }

  function pauseTimer() {
    if (timerInterval) {
      clearInterval(timerInterval);
      timerInterval = null;
    }
  }

  function setTimerPreset(minutes, btn) {
    pauseTimer();
    timerPresetMinutes = minutes;
    timerSeconds = minutes * 60;
    updateTimerDisplay();
    localStorage.setItem(TIMER_PRESET_KEY, minutes);
    
    document.querySelectorAll('.preset-btn').forEach(function(b) {
      b.classList.remove('active');
    });
    btn.classList.add('active');
  }

  function setCustomTimer() {
    const minutes = parseInt(document.getElementById('customMinutes').value);
    if (minutes && minutes > 0 && minutes <= 180) {
      pauseTimer();
      timerPresetMinutes = minutes;
      timerSeconds = minutes * 60;
      updateTimerDisplay();
      localStorage.setItem(TIMER_PRESET_KEY, minutes);
      document.getElementById('customMinutes').value = '';
      
      document.querySelectorAll('.preset-btn').forEach(function(b) {
        b.classList.remove('active');
      });
    }
  }

  function resetTimer() {
    pauseTimer();
    timerSeconds = timerPresetMinutes * 60;
    updateTimerDisplay();
  }

  // DOSAGE CALCULATOR
  function calculate() {
    const ordered = parseFloat(document.getElementById('ordered').value);
    const available = parseFloat(document.getElementById('available').value);
    const volume = parseFloat(document.getElementById('volume').value);
    
    if (!ordered || !available || !volume) {
      document.getElementById('doseOutput').innerHTML = 
        '<div class="calc-result" style="background:rgba(220,38,38,0.1); color:var(--danger);">Please fill in all fields</div>';
      return;
    }
    
    const result = (ordered / available) * volume;
    document.getElementById('doseOutput').innerHTML = 
      '<div class="calc-result">üíâ Administer ' + result.toFixed(2) + ' mL</div>';
  }

  // NOTES
  function saveNotes() {
    const notes = document.getElementById('quickNotes').value;
    localStorage.setItem(NOTES_KEY, notes);
    alert('‚úì Notes saved successfully!');
  }

  function loadNotes() {
    const notes = localStorage.getItem(NOTES_KEY) || '';
    document.getElementById('quickNotes').value = notes;
  }

  // CHECKLIST
  function saveChecklist() {
    const checkboxes = document.querySelectorAll('.checklist input[type="checkbox"]');
    const states = Array.from(checkboxes).map(function(cb) { return cb.checked; });
    localStorage.setItem(CHECKLIST_KEY, JSON.stringify(states));
  }

  function loadChecklist() {
    const saved = localStorage.getItem(CHECKLIST_KEY);
    if (saved) {
      const states = JSON.parse(saved);
      const checkboxes = document.querySelectorAll('.checklist input[type="checkbox"]');
      checkboxes.forEach(function(cb, i) {
        cb.checked = states[i] || false;
      });
    }
  }

  function resetChecklist() {
    const checkboxes = document.querySelectorAll('.checklist input[type="checkbox"]');
    checkboxes.forEach(function(cb) {
      cb.checked = false;
    });
    saveChecklist();
  }

  // THEME
  function toggleTheme() {
    document.body.classList.toggle("dark");
    const isDark = document.body.classList.contains('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    document.getElementById('themeBtn').innerText = isDark ? '‚òÄÔ∏è' : 'üåô';
  }

  function loadTheme() {
    const theme = localStorage.getItem('theme');
    if (theme === 'dark') {
      document.body.classList.add('dark');
      document.getElementById('themeBtn').innerText = '‚òÄÔ∏è';
    }
  }

  // CALENDAR
  function renderCalendar() {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                        'July', 'August', 'September', 'October', 'November', 'December'];
    document.getElementById('calendarMonth').innerText = monthNames[month] + ' ' + year;
    
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const daysInPrevMonth = new Date(year, month, 0).getDate();
    
    const calendar = document.getElementById('calendar');
    calendar.innerHTML = '';
    calendar.className = 'calendar-grid';
    
    const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    dayHeaders.forEach(function(day) {
      const header = document.createElement('div');
      header.className = 'calendar-day-header';
      header.innerText = day;
      calendar.appendChild(header);
    });
    
    const today = new Date();
    const todayStr = today.toISOString().split('T')[0];
    
    for (let i = firstDay - 1; i >= 0; i--) {
      const day = document.createElement('div');
      day.className = 'calendar-day other-month';
      day.innerHTML = '<div class="calendar-day-number">' + (daysInPrevMonth - i) + '</div>';
      calendar.appendChild(day);
    }
    
    for (let day = 1; day <= daysInMonth; day++) {
      const dayElement = document.createElement('div');
      dayElement.className = 'calendar-day';
      
      const dateStr = year + '-' + String(month + 1).padStart(2, '0') + '-' + String(day).padStart(2, '0');
      
      if (dateStr === todayStr) {
        dayElement.classList.add('today');
      }
      
      const hasTasks = tasks.some(function(t) { return t.date === dateStr; });
      if (hasTasks) {
        dayElement.classList.add('has-tasks');
      }
      
      if (selectedDate === dateStr) {
        dayElement.classList.add('selected');
      }
      
      dayElement.innerHTML = '<div class="calendar-day-number">' + day + '</div>';
      dayElement.dataset.date = dateStr;
      
      calendar.appendChild(dayElement);
    }
    
    const totalCells = calendar.children.length - 7;
    const remainingCells = 42 - totalCells - 7;
    for (let day = 1; day <= remainingCells; day++) {
      const dayElement = document.createElement('div');
      dayElement.className = 'calendar-day other-month';
      dayElement.innerHTML = '<div class="calendar-day-number">' + day + '</div>';
      calendar.appendChild(dayElement);
    }
  }

  function selectDate(dateStr) {
    selectedDate = dateStr;
    renderCalendar();
    showDayEvents(dateStr);
  }

  function showDayEvents(dateStr) {
    const container = document.getElementById('dayEvents');
    const dayTasks = tasks.filter(function(t) { return t.date === dateStr; });
    
    if (dayTasks.length === 0) {
      container.innerHTML = '<div style="text-align:center; color:var(--muted); padding:20px;"><p>No tasks scheduled for ' + formatDate(dateStr) + '</p></div>';
      return;
    }
    
    const date = new Date(dateStr);
    container.innerHTML = '<h3 style="margin-bottom:12px; font-size:16px;">Tasks for ' + 
      date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' }) + '</h3>';
    
    dayTasks.forEach(function(task) {
      const div = document.createElement('div');
      div.className = 'event-item priority-' + task.priority;
      div.innerHTML = 
        '<div style="display:flex; justify-content:space-between; align-items:center;">' +
          '<div>' +
            '<div style="font-weight:600; margin-bottom:4px;">' + task.text + '</div>' +
            '<div style="font-size:12px; color:var(--muted);">' +
              task.subject + ' ¬∑ ' + task.priority.toUpperCase() +
            '</div>' +
          '</div>' +
          '<div style="display:flex; gap:8px;">' +
            (task.done ? '<span style="color:var(--success); font-size:20px;">‚úì</span>' : '') +
          '</div>' +
        '</div>';
      container.appendChild(div);
    });
  }

  function previousMonth() {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar();
    if (selectedDate) {
      showDayEvents(selectedDate);
    }
  }

  function nextMonth() {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar();
    if (selectedDate) {
      showDayEvents(selectedDate);
    }
  }

  // EVENT LISTENERS
  document.getElementById('themeBtn').addEventListener('click', toggleTheme);
  document.getElementById('addTaskBtn').addEventListener('click', addTask);
  document.getElementById('startTimerBtn').addEventListener('click', startTimer);
  document.getElementById('pauseTimerBtn').addEventListener('click', pauseTimer);
  document.getElementById('resetTimerBtn').addEventListener('click', resetTimer);
  document.getElementById('setCustomTimerBtn').addEventListener('click', setCustomTimer);
  document.getElementById('calculateBtn').addEventListener('click', calculate);
  document.getElementById('saveNotesBtn').addEventListener('click', saveNotes);
  document.getElementById('resetChecklistBtn').addEventListener('click', resetChecklist);
  document.getElementById('prevMonthBtn').addEventListener('click', previousMonth);
  document.getElementById('nextMonthBtn').addEventListener('click', nextMonth);

  // Filter tabs
  document.querySelectorAll('.filter-tab').forEach(function(tab) {
    tab.addEventListener('click', function() {
      filterTasks(this.dataset.filter);
    });
  });

  // Timer presets
  document.querySelectorAll('.preset-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      setTimerPreset(parseInt(this.dataset.minutes), this);
    });
  });

  // Task list delegation
  document.getElementById('taskList').addEventListener('click', function(e) {
    const btn = e.target.closest('[data-action]');
    if (btn) {
      const action = btn.dataset.action;
      const index = parseInt(btn.dataset.index);
      if (action === 'toggle') {
        toggleTask(index);
      } else if (action === 'remove') {
        removeTask(index);
      }
    }
  });

  // Calendar day clicks
  document.getElementById('calendar').addEventListener('click', function(e) {
    const day = e.target.closest('.calendar-day');
    if (day && day.dataset.date && !day.classList.contains('other-month')) {
      selectDate(day.dataset.date);
    }
  });

  // Checklist changes
  document.getElementById('checklist').addEventListener('change', saveChecklist);

  // Handle window resize for confetti canvas
  window.addEventListener('resize', function() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  });

  // INITIALIZE
  loadTheme();
  loadNotes();
  loadChecklist();
  render();
  renderCalendar();
  updateTimerDisplay();

  const savedPreset = localStorage.getItem(TIMER_PRESET_KEY);
  if (savedPreset) {
    timerPresetMinutes = parseInt(savedPreset);
    timerSeconds = timerPresetMinutes * 60;
    updateTimerDisplay();
    
    document.querySelectorAll('.preset-btn').forEach(function(btn) {
      if (parseInt(btn.dataset.minutes) === timerPresetMinutes) {
        btn.classList.add('active');
      }
    });
  }

  document.getElementById('taskDate').valueAsDate = new Date();

  updateGraduationCountdown();
  graduationCountdownInterval = setInterval(updateGraduationCountdown, 60000);
})();
</script>

</body>
</html>
