<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Nursing Productivity">
<title>Nursing Productivity System ‚Äì Kalicia Szabo</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#f8fafc; --card:#ffffff; --text:#0f172a; --muted:#64748b;
  --accent:#2563eb; --accent-light:#dbeafe; --success:#16a34a;
  --warning:#d97706; --danger:#dc2626; --border:#e5e7eb;
  --shadow:0 2px 4px rgba(0,0,0,0.08); --shadow-lg:0 12px 32px rgba(0,0,0,0.12);
}
.dark {
  --bg:#020617; --card:#0f172a; --text:#e5e7eb; --muted:#94a3b8;
  --accent-light:#1e3a8a; --border:#1e293b;
  --shadow:0 2px 4px rgba(0,0,0,0.4); --shadow-lg:0 12px 32px rgba(0,0,0,0.5);
}
* { box-sizing:border-box; margin:0; padding:0; -webkit-tap-highlight-color:transparent; }
body {
  background:var(--bg);
  background-image:url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=2070&auto=format&fit=crop');
  background-size:cover; background-position:center; background-attachment:fixed;
  color:var(--text); font-family:'Poppins',-apple-system,sans-serif; line-height:1.6;
  touch-action:pan-y; -webkit-user-select:none; user-select:none; overflow-x:hidden;
}
input,textarea { -webkit-user-select:text; user-select:text; }
body::before {
  content:''; position:fixed; top:0; left:0; right:0; bottom:0;
  background:rgba(248,250,252,0.85); z-index:-1; transition:background 0.3s;
}
body.dark::before { background:rgba(2,6,23,0.92); }
body.dark { background-image:url('https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=2070&auto=format&fit=crop'); }
.container { max-width:1024px; margin:auto; padding:24px; }
#confetti-canvas { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; }

header {
  background:rgba(255,255,255,0.95); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border:1px solid var(--border); border-radius:20px; padding:28px; margin-bottom:28px;
  box-shadow:var(--shadow-lg); display:flex; justify-content:space-between; align-items:center; gap:20px;
}
.dark header { background:rgba(15,23,42,0.95); }
.header-left { display:flex; align-items:center; gap:20px; flex:1; }
.logo-container {
  width:90px; height:90px; background:linear-gradient(135deg,#dc2626,#991b1b);
  border-radius:16px; display:flex; align-items:center; justify-content:center;
  box-shadow:var(--shadow-lg); flex-shrink:0;
}
.logo-text { color:white; font-weight:700; font-size:36px; letter-spacing:-1px; }
.header-info h1 {
  font-family:'Playfair Display',serif; font-size:38px; font-weight:900; margin-bottom:6px;
  background:linear-gradient(135deg,#2563eb,#7c3aed); -webkit-background-clip:text;
  -webkit-text-fill-color:transparent; background-clip:text; letter-spacing:-0.5px;
}
.header-info .subtitle { color:var(--muted); font-size:15px; display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.badge { background:var(--accent-light); color:var(--accent); padding:6px 12px; border-radius:8px; font-size:13px; font-weight:600; }

button {
  padding:14px 22px; border-radius:12px; border:1px solid var(--border); background:var(--card);
  color:var(--text); cursor:pointer; font-weight:500; transition:all 0.2s; box-shadow:var(--shadow);
  font-size:16px; min-height:48px; min-width:48px; touch-action:manipulation;
}
button:active { transform:scale(0.96); background:var(--accent-light); }
.btn-primary { background:var(--accent); color:white; border-color:var(--accent); }
.btn-primary:active { background:#1d4ed8; }

.ipad-grid { display:grid; grid-template-columns:1fr 1fr; gap:24px; margin-bottom:28px; }
.grid { display:grid; grid-template-columns:repeat(2,1fr); gap:20px; margin-bottom:28px; }

.card {
  background:rgba(255,255,255,0.95); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
  border:1px solid var(--border); border-radius:20px; padding:24px; box-shadow:var(--shadow);
}
.dark .card { background:rgba(15,23,42,0.95); }
.card h3 { font-size:14px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:14px; }
.stat { font-size:40px; font-weight:700; background:linear-gradient(135deg,var(--accent),#7c3aed); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.stat-label { color:var(--muted); font-size:13px; margin-top:6px; }

.graduation-card {
  background:linear-gradient(135deg,#7c3aed,#2563eb); color:white;
  padding:28px; border-radius:20px; box-shadow:var(--shadow-lg); margin-bottom:28px;
  position:relative; overflow:hidden;
}
.graduation-card::before { content:'üéì'; position:absolute; top:-20px; right:-20px; font-size:120px; opacity:0.15; }
.graduation-card h2 { font-family:'Playfair Display',serif; font-size:32px; font-weight:900; margin-bottom:12px; position:relative; }
.graduation-card .countdown { font-size:52px; font-weight:700; margin:16px 0; position:relative; }
.graduation-card .subtitle { font-size:16px; opacity:0.9; position:relative; }
.graduation-card .grad-date { font-size:13px; opacity:0.7; margin-top:6px; position:relative; }

.filter-tabs { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
.filter-tab {
  padding:10px 18px; border-radius:10px; background:var(--card); border:1px solid var(--border);
  cursor:pointer; font-size:14px; font-weight:500; transition:all 0.2s; min-height:44px;
}
.filter-tab.active { background:var(--accent); color:white; border-color:var(--accent); }
.filter-tab:active { transform:scale(0.95); }

.task-form { display:flex; flex-direction:column; gap:14px; margin-bottom:20px; }
.task-form input,.task-form select {
  padding:14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px; font-family:inherit;
}
.task-form input:focus,.task-form select:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.task-item {
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  padding:16px; margin-bottom:12px; display:flex; align-items:center; gap:14px; transition:all 0.2s;
}
.task-item.done { opacity:0.6; }
.task-item.done .task-text { text-decoration:line-through; }
.task-checkbox {
  width:28px; height:28px; border-radius:50%; border:2px solid var(--border);
  cursor:pointer; flex-shrink:0; display:flex; align-items:center; justify-content:center;
  transition:all 0.2s; min-width:28px; min-height:28px;
}
.task-checkbox.checked { background:var(--success); border-color:var(--success); color:white; }
.task-content { flex:1; }
.task-text { font-weight:500; font-size:15px; margin-bottom:4px; }
.task-meta { display:flex; gap:10px; font-size:12px; color:var(--muted); flex-wrap:wrap; }
.priority-high { border-left:4px solid var(--danger); }
.priority-medium { border-left:4px solid var(--warning); }
.priority-low { border-left:4px solid var(--accent); }
.task-actions button { padding:8px 12px; min-width:auto; min-height:36px; font-size:14px; }

.timer-display {
  font-size:64px; font-weight:700; text-align:center; margin:24px 0; font-variant-numeric:tabular-nums;
  background:linear-gradient(135deg,var(--accent),#7c3aed); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}
.timer-controls { display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-bottom:20px; }
.timer-presets { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px; }
.preset-btn { padding:12px; font-size:14px; }
.preset-btn.active { background:var(--accent); color:white; border-color:var(--accent); }
.custom-timer { display:flex; gap:10px; align-items:center; margin-bottom:20px; }
.custom-timer input {
  flex:1; padding:12px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px;
}
.custom-timer input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.calc-grid { display:grid; gap:14px; margin-bottom:20px; }
.calc-input { display:flex; flex-direction:column; gap:8px; }
.calc-input label { font-size:13px; font-weight:600; color:var(--muted); }
.calc-input input,.calc-input select {
  padding:14px; border-radius:10px; border:1px solid var(--border); background:var(--card); color:var(--text); font-size:15px;
}
.calc-input input:focus,.calc-input select:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }
.calc-result { background:var(--accent-light); color:var(--accent); padding:18px; border-radius:12px; text-align:center; font-size:18px; font-weight:600; margin-top:14px; }

textarea {
  width:100%; padding:14px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px; font-family:inherit; resize:vertical; min-height:180px;
}
textarea:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }

.checklist { display:flex; flex-direction:column; gap:12px; }
.checklist-item {
  display:flex; align-items:center; gap:12px; padding:14px;
  background:var(--card); border:1px solid var(--border); border-radius:10px;
}
.checklist-item input[type="checkbox"] { width:24px; height:24px; cursor:pointer; min-width:24px; min-height:24px; }
.checklist-item label { flex:1; cursor:pointer; font-size:15px; }

.calendar-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
.calendar-header h3 { font-size:20px; font-weight:700; text-transform:none; }
.calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; }
.calendar-day-header { text-align:center; font-size:12px; font-weight:600; color:var(--muted); padding:10px; }
.calendar-day {
  aspect-ratio:1; display:flex; align-items:center; justify-content:center;
  border-radius:10px; cursor:pointer; transition:all 0.2s; position:relative;
  background:var(--card); border:1px solid var(--border); min-height:52px;
}
.calendar-day.today { background:var(--accent-light); border-color:var(--accent); font-weight:600; }
.calendar-day.selected { background:var(--accent); color:white; border-color:var(--accent); }
.calendar-day.has-tasks::after { content:''; position:absolute; bottom:6px; width:6px; height:6px; background:var(--accent); border-radius:50%; }
.calendar-day.selected.has-tasks::after { background:white; }
.calendar-day.other-month { opacity:0.3; cursor:default; }
.calendar-day-number { font-size:15px; font-weight:500; }

.event-item { background:var(--card); border:1px solid var(--border); border-radius:10px; padding:14px; margin-bottom:10px; }
.event-item.priority-high { border-left:4px solid var(--danger); }
.event-item.priority-medium { border-left:4px solid var(--warning); }
.event-item.priority-low { border-left:4px solid var(--accent); }
#dayEvents { margin-top:20px; padding:20px; background:rgba(255,255,255,0.5); border-radius:12px; min-height:120px; }
.dark #dayEvents { background:rgba(15,23,42,0.5); }

.empty-state { text-align:center; color:var(--muted); padding:40px 20px; font-size:15px; }
.empty-state::before { content:'üìã'; display:block; font-size:48px; margin-bottom:12px; }

/* ========== ENHANCED MEDICATION LOOKUP STYLES ========== */
.med-section-header {
  display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; flex-wrap:wrap; gap:10px;
}
.med-count-badge {
  background:linear-gradient(135deg,var(--accent),#7c3aed);
  color:white; padding:4px 12px; border-radius:20px; font-size:12px; font-weight:600;
}
.med-search-wrapper { position:relative; margin-bottom:12px; }
.med-search-icon { position:absolute; left:14px; top:50%; transform:translateY(-50%); font-size:16px; pointer-events:none; }
.med-search-wrapper input {
  width:100%; padding:14px 14px 14px 42px; border-radius:10px; border:1px solid var(--border);
  background:var(--card); color:var(--text); font-size:15px; font-family:inherit;
}
.med-search-wrapper input:focus { outline:none; border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-light); }
.med-clear-btn {
  position:absolute; right:12px; top:50%; transform:translateY(-50%);
  background:var(--muted); color:white; border:none; border-radius:50%;
  width:22px; height:22px; min-width:22px; min-height:22px;
  padding:0; cursor:pointer; font-size:14px; display:none; align-items:center; justify-content:center; box-shadow:none;
}

.med-category-filters {
  display:flex; gap:8px; margin-bottom:14px; overflow-x:auto; padding-bottom:4px;
  scrollbar-width:none; -webkit-overflow-scrolling:touch;
}
.med-category-filters::-webkit-scrollbar { display:none; }
.med-cat-btn {
  padding:7px 14px; border-radius:8px; background:var(--card); border:1px solid var(--border);
  cursor:pointer; font-size:12px; font-weight:600; white-space:nowrap; transition:all 0.2s;
  min-height:36px; box-shadow:none;
}
.med-cat-btn.active { background:var(--accent); color:white; border-color:var(--accent); }

.med-results { max-height:420px; overflow-y:auto; scrollbar-width:thin; }
.med-results::-webkit-scrollbar { width:4px; }
.med-results::-webkit-scrollbar-track { background:transparent; }
.med-results::-webkit-scrollbar-thumb { background:var(--border); border-radius:4px; }

.med-item {
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  padding:14px 16px; margin-bottom:10px; cursor:pointer; transition:all 0.2s;
  display:flex; align-items:center; gap:12px;
}
.med-item:active { transform:scale(0.98); background:var(--accent-light); }
.med-item-icon {
  width:40px; height:40px; border-radius:10px; display:flex; align-items:center; justify-content:center;
  font-size:18px; flex-shrink:0; background:var(--accent-light);
}
.med-item-body { flex:1; min-width:0; }
.med-name { font-weight:600; font-size:15px; margin-bottom:3px; color:var(--accent); }
.med-name mark { background:rgba(37,99,235,0.15); color:var(--accent); border-radius:3px; padding:0 2px; }
.med-generic { font-size:12px; color:var(--muted); font-style:italic; margin-bottom:3px; }
.med-class { font-size:12px; color:var(--muted); }
.med-class-tag {
  display:inline-block; background:var(--accent-light); color:var(--accent);
  border-radius:6px; padding:2px 8px; font-size:11px; font-weight:600;
}
.med-arrow { color:var(--muted); font-size:18px; }

/* Detail view */
.med-detail-view { animation: fadeSlideIn 0.2s ease; }
@keyframes fadeSlideIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
.med-detail-header {
  background:linear-gradient(135deg,var(--accent),#7c3aed); color:white;
  border-radius:12px; padding:18px; margin-bottom:16px;
}
.med-detail-header .med-detail-name { font-size:20px; font-weight:700; margin-bottom:4px; }
.med-detail-header .med-detail-generic { font-size:13px; opacity:0.85; margin-bottom:6px; font-style:italic; }
.med-detail-header .med-detail-class { background:rgba(255,255,255,0.2); display:inline-block; border-radius:6px; padding:3px 10px; font-size:12px; font-weight:600; }
.med-detail-section { margin-bottom:16px; }
.med-detail-section h4 {
  font-size:13px; font-weight:700; color:var(--accent); text-transform:uppercase;
  letter-spacing:0.5px; margin-bottom:8px; display:flex; align-items:center; gap:6px;
}
.med-detail-section p, .med-detail-section ul { font-size:14px; line-height:1.7; color:var(--text); }
.med-detail-section ul { padding-left:18px; }
.med-detail-section li { margin-bottom:3px; }
.med-tags { display:flex; flex-wrap:wrap; gap:6px; }
.med-tag-red { background:rgba(220,38,38,0.1); color:var(--danger); border-radius:6px; padding:4px 10px; font-size:12px; font-weight:500; }
.med-tag-yellow { background:rgba(217,119,6,0.1); color:var(--warning); border-radius:6px; padding:4px 10px; font-size:12px; font-weight:500; }
.med-tag-green { background:rgba(22,163,74,0.1); color:var(--success); border-radius:6px; padding:4px 10px; font-size:12px; font-weight:500; }
.med-tag-blue { background:var(--accent-light); color:var(--accent); border-radius:6px; padding:4px 10px; font-size:12px; font-weight:500; }
.med-nursing-box {
  background:rgba(22,163,74,0.08); border:1px solid rgba(22,163,74,0.3);
  border-radius:10px; padding:14px;
}
.med-nursing-box p { font-size:14px; line-height:1.7; color:var(--text); }
.med-back-btn { 
  display:flex; align-items:center; gap:8px; padding:10px 16px; margin-bottom:14px;
  background:var(--card); border:1px solid var(--border); border-radius:10px;
  cursor:pointer; font-size:14px; font-weight:500; color:var(--muted); transition:all 0.2s;
  min-height:40px; box-shadow:none;
}
.med-back-btn:hover { color:var(--accent); border-color:var(--accent); }

.med-no-results { text-align:center; padding:30px 20px; color:var(--muted); }
.med-no-results .med-no-results-icon { font-size:40px; display:block; margin-bottom:10px; }
.med-no-results p { font-size:14px; }

.med-search-hint { text-align:center; padding:20px; color:var(--muted); font-size:13px; }
.med-search-hint .hint-icon { font-size:36px; display:block; margin-bottom:8px; }

/* ========== END MED STYLES ========== */

.photo-upload-container { margin-top:14px; }
.photo-upload-btn {
  width:100%; padding:14px; background:var(--accent-light); color:var(--accent);
  border:2px dashed var(--accent); border-radius:10px; cursor:pointer; font-weight:600;
  display:flex; align-items:center; justify-content:center; gap:8px; transition:all 0.2s;
}
.photo-upload-btn:hover { background:var(--accent); color:white; }
#photoInput { display:none; }
.photo-preview-container { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:12px; margin-top:14px; }
.photo-preview { position:relative; border-radius:10px; overflow:hidden; aspect-ratio:1; background:var(--border); }
.photo-preview img { width:100%; height:100%; object-fit:cover; }
.photo-delete {
  position:absolute; top:4px; right:4px; background:var(--danger); color:white;
  border:none; border-radius:50%; width:28px; height:28px; min-width:28px; min-height:28px;
  padding:0; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:16px;
}

.tab-container { display:flex; gap:10px; margin-bottom:20px; border-bottom:2px solid var(--border); }
.tab {
  padding:12px 20px; background:transparent; border:none; border-bottom:3px solid transparent;
  cursor:pointer; font-weight:500; font-size:15px; color:var(--muted); transition:all 0.2s;
  min-height:auto; box-shadow:none;
}
.tab.active { color:var(--accent); border-bottom-color:var(--accent); }
.tab-content { display:none; }
.tab-content.active { display:block; }
</style>
</head>
<body>
<canvas id="confetti-canvas"></canvas>
<div class="container">
  <header>
    <div class="header-left">
      <div class="logo-container"><div class="logo-text">KJ</div></div>
      <div class="header-info">
        <h1>Kalicia Szabo</h1>
        <div class="subtitle"><span>Nursing Student</span><span class="badge">ADN Program</span></div>
      </div>
    </div>
    <button id="themeBtn">üåô</button>
  </header>

  <div class="graduation-card">
    <h2>üéì Graduation Countdown</h2>
    <div class="countdown" id="graduationCountdown">Loading...</div>
    <div class="subtitle">Days until you become a Registered Nurse!</div>
    <div class="grad-date">üóìÔ∏è Target: December 5, 2026</div>
  </div>

  <div class="grid">
    <div class="card">
      <h3>Tasks This Week</h3>
      <div class="stat" id="weekTaskCount">0</div>
      <div class="stat-label">Total tasks</div>
    </div>
    <div class="card">
      <h3>Completed Today</h3>
      <div class="stat" id="completedCount">0</div>
      <div class="stat-label">Tasks done</div>
    </div>
  </div>

  <div class="ipad-grid">
    <div>
      <div class="card">
        <h3>üìù Task Manager</h3>
        <div class="filter-tabs">
          <div class="filter-tab active" data-filter="all">All</div>
          <div class="filter-tab" data-filter="today">Today</div>
          <div class="filter-tab" data-filter="week">Week</div>
        </div>
        <div class="task-form">
          <input type="text" id="taskInput" placeholder="Enter task description...">
          <select id="taskSubject">
            <option>Pharmacology</option><option>Med-Surg</option><option>Fundamentals</option>
            <option>Mental Health</option><option>Pediatrics</option><option>OB/GYN</option>
            <option>Clinical</option><option>Study</option><option>Personal</option>
          </select>
          <select id="taskPriority">
            <option value="high">High Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="low">Low Priority</option>
          </select>
          <input type="date" id="taskDate">
          <button id="addTaskBtn" class="btn-primary">Add Task</button>
        </div>
        <div id="taskList"></div>
      </div>

      <div class="card" style="margin-top:24px;">
        <h3>‚è±Ô∏è Pomodoro Timer</h3>
        <div class="timer-presets">
          <button class="preset-btn active" data-minutes="25">25 min</button>
          <button class="preset-btn" data-minutes="15">15 min</button>
          <button class="preset-btn" data-minutes="45">45 min</button>
          <button class="preset-btn" data-minutes="60">60 min</button>
        </div>
        <div class="custom-timer">
          <input type="number" id="customMinutes" placeholder="Custom minutes" min="1" max="180">
          <button id="setCustomTimerBtn">Set</button>
        </div>
        <div class="timer-display" id="timerDisplay">25:00</div>
        <div class="timer-controls">
          <button id="startTimerBtn" class="btn-primary">Start</button>
          <button id="pauseTimerBtn">Pause</button>
          <button id="resetTimerBtn">Reset</button>
        </div>
      </div>
    </div>

    <div>
      <div class="card">
        <div class="calendar-header">
          <button id="prevMonthBtn">‚Üê</button>
          <h3 id="calendarMonth">Month Year</h3>
          <button id="nextMonthBtn">‚Üí</button>
        </div>
        <div id="calendar" class="calendar-grid"></div>
        <div id="dayEvents"></div>
      </div>

      <!-- ENHANCED MEDICATION DATABASE -->
      <div class="card" style="margin-top:24px;">
        <div class="med-section-header">
          <h3 style="margin:0;">üíä Medication Database</h3>
          <span class="med-count-badge" id="medCountBadge">65 Meds</span>
        </div>

        <div class="med-search-wrapper">
          <span class="med-search-icon">üîç</span>
          <input type="text" id="medSearch" placeholder="Search by name, brand, or drug class..." autocomplete="off">
          <button class="med-clear-btn" id="medClearBtn">‚úï</button>
        </div>

        <div class="med-category-filters" id="medCategoryFilters">
          <button class="med-cat-btn active" data-cat="all">All</button>
          <button class="med-cat-btn" data-cat="Analgesic">Pain</button>
          <button class="med-cat-btn" data-cat="Antibiotic">Antibiotics</button>
          <button class="med-cat-btn" data-cat="Anticoagulant">Blood</button>
          <button class="med-cat-btn" data-cat="Cardiac">Cardiac</button>
          <button class="med-cat-btn" data-cat="Antidiabetic">Diabetes</button>
          <button class="med-cat-btn" data-cat="Respiratory">Respiratory</button>
          <button class="med-cat-btn" data-cat="Psych">Psych</button>
          <button class="med-cat-btn" data-cat="GI">GI</button>
          <button class="med-cat-btn" data-cat="Neuro">Neuro</button>
          <button class="med-cat-btn" data-cat="Endocrine">Endocrine</button>
          <button class="med-cat-btn" data-cat="Steroid">Steroids</button>
        </div>

        <div class="med-results" id="medResults"></div>
      </div>
    </div>
  </div>

  <div class="ipad-grid">
    <div class="card">
      <h3>üíâ Calculators</h3>
      <div class="tab-container">
        <button class="tab active" data-tab="dosage">Dosage</button>
        <button class="tab" data-tab="iv">IV Drip Rate</button>
      </div>
      <div id="dosageTab" class="tab-content active">
        <div class="calc-grid">
          <div class="calc-input"><label>Ordered Dose (mg)</label><input type="number" id="ordered" placeholder="e.g., 500" step="0.01"></div>
          <div class="calc-input"><label>Available Strength (mg)</label><input type="number" id="available" placeholder="e.g., 250" step="0.01"></div>
          <div class="calc-input"><label>Available Volume (mL)</label><input type="number" id="volume" placeholder="e.g., 5" step="0.01"></div>
        </div>
        <button id="calculateBtn" class="btn-primary" style="width:100%;">Calculate Dose</button>
        <div id="doseOutput"></div>
      </div>
      <div id="ivTab" class="tab-content">
        <div class="calc-grid">
          <div class="calc-input"><label>Total Volume (mL)</label><input type="number" id="ivVolume" placeholder="e.g., 1000" step="1"></div>
          <div class="calc-input"><label>Time (hours)</label><input type="number" id="ivTime" placeholder="e.g., 8" step="0.1"></div>
          <div class="calc-input">
            <label>Drop Factor (gtts/mL)</label>
            <select id="dropFactor">
              <option value="10">10 gtts/mL (Blood tubing)</option>
              <option value="15">15 gtts/mL (Standard)</option>
              <option value="20" selected>20 gtts/mL (Standard)</option>
              <option value="60">60 gtts/mL (Microdrip)</option>
            </select>
          </div>
        </div>
        <button id="calculateIVBtn" class="btn-primary" style="width:100%;">Calculate IV Rate</button>
        <div id="ivOutput"></div>
      </div>
    </div>

    <div class="card">
      <h3>üìì Quick Notes</h3>
      <textarea id="quickNotes" placeholder="Type your notes here..."></textarea>
      <div class="photo-upload-container">
        <label for="photoInput" class="photo-upload-btn">üì∑ Add Photo</label>
        <input type="file" id="photoInput" accept="image/*" multiple>
        <div class="photo-preview-container" id="photoPreviewContainer"></div>
      </div>
      <button id="saveNotesBtn" class="btn-primary" style="width:100%;margin-top:14px;">Save Notes</button>
    </div>
  </div>

  <div class="card" style="margin-bottom:28px;">
    <h3>‚úÖ Shift Checklist</h3>
    <div id="checklist" class="checklist">
      <div class="checklist-item"><input type="checkbox" id="check1"><label for="check1">Review patient charts</label></div>
      <div class="checklist-item"><input type="checkbox" id="check2"><label for="check2">Check medication orders</label></div>
      <div class="checklist-item"><input type="checkbox" id="check3"><label for="check3">Verify allergies</label></div>
      <div class="checklist-item"><input type="checkbox" id="check4"><label for="check4">Complete vital signs</label></div>
      <div class="checklist-item"><input type="checkbox" id="check5"><label for="check5">Document assessments</label></div>
      <div class="checklist-item"><input type="checkbox" id="check6"><label for="check6">Hand-off report</label></div>
    </div>
    <button id="resetChecklistBtn" style="margin-top:14px;">Reset Checklist</button>
  </div>
</div>

<script>
(function() {
  'use strict';

  const TASKS_KEY = 'nursingTasks';
  const NOTES_KEY = 'nursingNotes';
  const PHOTOS_KEY = 'nursingPhotos';
  const CHECKLIST_KEY = 'nursingChecklist';
  const TIMER_PRESET_KEY = 'timerPreset';

  let tasks = JSON.parse(localStorage.getItem(TASKS_KEY)) || [];
  let notePhotos = JSON.parse(localStorage.getItem(PHOTOS_KEY)) || [];
  let currentFilter = 'all';
  let timerSeconds = 25 * 60;
  let timerInterval = null;
  let timerPresetMinutes = 25;
  let currentDate = new Date();
  let selectedDate = null;
  let selectedMed = null;
  let medActiveCat = 'all';
  let medSearchQuery = '';

  // ======================================================
  // ‚úÖ GRADUATION COUNTDOWN ‚Äî Fixed to December 5, 2026
  // ======================================================
  function updateGraduationCountdown() {
    var now = new Date();
    var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    var grad  = new Date(2026, 11, 5);
    var diffDays = Math.round((grad - today) / (1000 * 60 * 60 * 24));
    var el = document.getElementById('graduationCountdown');
    if (diffDays > 0) {
      el.innerText = diffDays + (diffDays === 1 ? ' Day' : ' Days');
    } else if (diffDays === 0) {
      el.innerText = 'üéâ Today is the Day!';
      showConfetti();
    } else {
      el.innerText = 'üéì Congratulations, RN!';
    }
  }

  // ======================================================
  // üíä ENHANCED MEDICATION DATABASE (65 medications)
  // Each med has: name, generic, brand, class, category, icon,
  //               indications, dosage, route, sideEffects,
  //               nursing, contraindications, antidote, peakOnset
  // ======================================================
  const medications = [
    // ‚îÄ‚îÄ ANALGESICS / PAIN ‚îÄ‚îÄ
    { name:"Acetaminophen", brand:"Tylenol", class:"Analgesic, Antipyretic", category:"Analgesic", icon:"üå°Ô∏è",
      indications:"Mild-moderate pain, fever reduction", route:"PO, PR, IV",
      dosage:"Adults: 325‚Äì650mg q4-6h PO; max 4000mg/day (3000mg in elderly/liver risk). IV: 650‚Äì1000mg q6-8h.",
      sideEffects:["Nausea (rare at normal doses)","Rash","Hepatotoxicity (overdose)"],
      nursing:"Monitor LFTs with chronic use. Do not exceed max dose. Check all combo products for hidden acetaminophen. Antidote: N-acetylcysteine.",
      contraindications:"Severe hepatic impairment, alcohol use disorder", antidote:"N-acetylcysteine (NAC)" },
    { name:"Ibuprofen", brand:"Advil, Motrin", class:"NSAID", category:"Analgesic", icon:"üíä",
      indications:"Pain, fever, inflammation, dysmenorrhea",route:"PO",
      dosage:"200‚Äì800mg q6-8h with food; max 3200mg/day",
      sideEffects:["GI upset/ulceration","Renal impairment","Hypertension","Increased bleeding risk"],
      nursing:"Give with food or milk. Monitor renal function and BP. Avoid in patients with peptic ulcer disease.",
      contraindications:"Active GI bleed, renal failure, 3rd trimester pregnancy, CABG perioperative" },
    { name:"Morphine", brand:"MS Contin, Roxanol", class:"Opioid Analgesic (Schedule II)", category:"Analgesic", icon:"üíâ",
      indications:"Moderate‚Äìsevere pain, acute MI, pulmonary edema",route:"IV, IM, SubQ, PO",
      dosage:"IV: 2‚Äì4mg q3-4h PRN; PO: 10‚Äì30mg q4h (IR); ER: 15‚Äì30mg q8-12h",
      sideEffects:["Respiratory depression","Constipation","Sedation","Nausea","Miosis","Urinary retention"],
      nursing:"Hold if RR <12. Have naloxone available. Monitor O2 sat. Implement bowel regimen. Assess pain level 30‚Äì60 min post-dose.",
      contraindications:"Respiratory depression, paralytic ileus, acute asthma", antidote:"Naloxone (Narcan)" },
    { name:"Oxycodone", brand:"OxyContin, Percocet", class:"Opioid Analgesic (Schedule II)", category:"Analgesic", icon:"üíâ",
      indications:"Moderate-severe pain",route:"PO",
      dosage:"IR: 5‚Äì15mg q4-6h PRN; ER: 10‚Äì40mg q12h",
      sideEffects:["Respiratory depression","Constipation","Sedation","Dizziness","Nausea"],
      nursing:"Monitor RR, pain level, sedation scale. Risk of addiction/misuse. Never crush ER form. Bowel regimen needed.",
      contraindications:"Respiratory depression, GI obstruction", antidote:"Naloxone (Narcan)" },
    { name:"Hydromorphone", brand:"Dilaudid", class:"Opioid Analgesic (Schedule II)", category:"Analgesic", icon:"üíâ",
      indications:"Moderate-severe pain; 5‚Äì10x more potent than morphine",route:"IV, IM, PO",
      dosage:"IV: 0.2‚Äì0.6mg q2-3h; PO: 2‚Äì4mg q4-6h",
      sideEffects:["Respiratory depression","Sedation","Hypotension","Constipation"],
      nursing:"High-alert medication. Very potent ‚Äî verify dose carefully. Monitor RR closely. Have naloxone ready.",
      contraindications:"Respiratory depression, acute asthma", antidote:"Naloxone (Narcan)" },
    { name:"Tramadol", brand:"Ultram", class:"Opioid-like Analgesic (Schedule IV)", category:"Analgesic", icon:"üíä",
      indications:"Moderate pain",route:"PO",
      dosage:"50‚Äì100mg q4-6h; max 400mg/day (300mg in elderly)",
      sideEffects:["Dizziness","Constipation","Nausea","Seizure risk","Serotonin syndrome"],
      nursing:"Lower seizure threshold ‚Äî caution with seizure hx. Avoid with SSRIs (serotonin syndrome risk). Less respiratory depression than opioids.",
      contraindications:"Seizure disorder, MAOIs, severe hepatic/renal impairment" },

    // ‚îÄ‚îÄ ANTIBIOTICS ‚îÄ‚îÄ
    { name:"Amoxicillin", brand:"Amoxil", class:"Antibiotic ‚Äì Penicillin", category:"Antibiotic", icon:"ü¶†",
      indications:"Ear, sinus, throat, UTI, H. pylori (combo)",route:"PO",
      dosage:"250‚Äì500mg q8h or 875mg q12h; pediatric: 25‚Äì45mg/kg/day divided",
      sideEffects:["Diarrhea","Nausea","Rash","Allergic reactions"],
      nursing:"Ask about penicillin allergy (cross-react with cephalosporins 1‚Äì2%). Encourage complete course. Monitor for C. diff.",
      contraindications:"Penicillin/amoxicillin allergy" },
    { name:"Cephalexin", brand:"Keflex", class:"Antibiotic ‚Äì Cephalosporin (1st gen)", category:"Antibiotic", icon:"ü¶†",
      indications:"Skin infections, UTI, strep throat, bone infections",route:"PO",
      dosage:"250‚Äì500mg q6h or 500mg q12h; max 4g/day",
      sideEffects:["GI upset","Rash","Diarrhea"],
      nursing:"Caution with PCN allergy (cross-reactivity <2%). Complete full course.",
      contraindications:"Cephalosporin allergy; use caution with PCN allergy" },
    { name:"Azithromycin", brand:"Zithromax, Z-Pack", class:"Antibiotic ‚Äì Macrolide", category:"Antibiotic", icon:"ü¶†",
      indications:"Community pneumonia, STIs, atypical bacteria, skin infections",route:"PO, IV",
      dosage:"500mg day 1 then 250mg days 2‚Äì5 (Z-Pack); or 500mg daily x3",
      sideEffects:["GI upset","QT prolongation","Hearing loss (high dose)","Hepatotoxicity"],
      nursing:"Monitor ECG in at-risk patients (QT prolongation). Take on empty stomach for better absorption. Avoid antacids.",
      contraindications:"QT prolongation, liver disease, macrolide allergy" },
    { name:"Ciprofloxacin", brand:"Cipro", class:"Antibiotic ‚Äì Fluoroquinolone", category:"Antibiotic", icon:"ü¶†",
      indications:"UTI, respiratory, GI infections, anthrax prophylaxis",route:"PO, IV",
      dosage:"250‚Äì750mg q12h PO; 200‚Äì400mg q8-12h IV",
      sideEffects:["Tendon rupture","Peripheral neuropathy","QT prolongation","Photosensitivity","C. diff"],
      nursing:"Avoid in patients <18 years (unless life-threatening), pregnant. No dairy or antacids within 2h. Encourage fluids.",
      contraindications:"Age <18 (relative), pregnancy, tendon disorders, QT prolongation" },
    { name:"Metronidazole", brand:"Flagyl", class:"Antibiotic ‚Äì Nitroimidazole", category:"Antibiotic", icon:"ü¶†",
      indications:"Anaerobic infections, C. diff, BV, H. pylori (combo), protozoal infections",route:"PO, IV",
      dosage:"250‚Äì500mg q6-8h PO; 500mg q6-8h IV",
      sideEffects:["Metallic taste","Nausea","Peripheral neuropathy","Disulfiram-like reaction with alcohol"],
      nursing:"Avoid alcohol during and 48h after treatment (severe disulfiram reaction). Metallic taste is common and expected.",
      contraindications:"First trimester pregnancy, alcohol use with treatment" },
    { name:"Clindamycin", brand:"Cleocin", class:"Antibiotic ‚Äì Lincosamide", category:"Antibiotic", icon:"ü¶†",
      indications:"Serious anaerobic/staphylococcal infections, skin infections, bone infections",route:"PO, IV, topical",
      dosage:"150‚Äì450mg q6h PO; 600‚Äì900mg q8h IV",
      sideEffects:["Diarrhea","C. diff (high risk)","GI upset","Rash"],
      nursing:"Highest risk antibiotic for C. diff. Monitor for diarrhea. Infuse IV over ‚â•30 min.",
      contraindications:"History of C. diff or pseudomembranous colitis, hypersensitivity" },
    { name:"Vancomycin", brand:"Vancocin", class:"Antibiotic ‚Äì Glycopeptide", category:"Antibiotic", icon:"ü¶†",
      indications:"MRSA, C. diff (PO only), serious Gram+ infections",route:"IV, PO (C. diff only)",
      dosage:"IV: 15‚Äì20mg/kg q8-12h (dose by levels/AUC); PO: 125‚Äì500mg q6h for C. diff",
      sideEffects:["Nephrotoxicity","Red Man Syndrome (rapid infusion)","Ototoxicity","Thrombophlebitis"],
      nursing:"Monitor vancomycin trough/AUC levels, renal function (SCr), and hearing. Infuse over ‚â•60 min. Pre-medicate with antihistamine if Red Man Syndrome occurs.",
      contraindications:"Allergy to vancomycin" },
    { name:"Trimethoprim-Sulfamethoxazole", brand:"Bactrim, Septra", class:"Antibiotic ‚Äì Sulfonamide", category:"Antibiotic", icon:"ü¶†",
      indications:"UTI, MRSA skin infections, PCP prophylaxis, Pneumocystis pneumonia",route:"PO, IV",
      dosage:"1 DS tablet q12h for uncomplicated UTI x3‚Äì5 days",
      sideEffects:["Rash/photosensitivity","Hyperkalemia","Renal impairment","Blood dyscrasia","Stevens-Johnson (rare)"],
      nursing:"Sulfa allergy? Avoid. Encourage fluids. Monitor K+ and renal function. Check G6PD status.",
      contraindications:"Sulfa allergy, severe renal impairment, folate deficiency, G6PD deficiency, pregnancy near term" },

    // ‚îÄ‚îÄ CARDIAC ‚îÄ‚îÄ
    { name:"Lisinopril", brand:"Zestril, Prinivil", class:"ACE Inhibitor", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"Hypertension, heart failure, post-MI renal protection, diabetic nephropathy",route:"PO",
      dosage:"HTN: 10mg daily initially; range 10‚Äì40mg/day. HF: 5‚Äì40mg/day.",
      sideEffects:["Dry cough","Dizziness/first-dose hypotension","Hyperkalemia","Angioedema"],
      nursing:"Monitor BP, K+, creatinine. Watch for angioedema (stop immediately). Avoid in pregnancy (teratogenic). Hold if K+ >5.5.",
      contraindications:"Pregnancy, angioedema history, bilateral renal artery stenosis, concurrent aliskiren (DM)" },
    { name:"Metoprolol", brand:"Lopressor (tartrate), Toprol-XL (succinate)", class:"Beta-1 Blocker (Cardioselective)", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"HTN, angina, HF (succinate), post-MI, afib rate control",route:"PO, IV",
      dosage:"PO HTN: 25‚Äì100mg q12h (tartrate) or 25‚Äì200mg daily (succinate). IV: 2.5‚Äì5mg q2min x3 doses.",
      sideEffects:["Bradycardia","Hypotension","Fatigue","Bronchospasm (high dose)","Masking hypoglycemia"],
      nursing:"Hold if HR <60 or SBP <90. Do not abruptly discontinue. Monitor glucose in diabetics.",
      contraindications:"Severe bradycardia, heart block, decompensated HF, cardiogenic shock" },
    { name:"Carvedilol", brand:"Coreg", class:"Alpha/Beta Blocker", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"Heart failure, HTN, post-MI LV dysfunction",route:"PO",
      dosage:"HF: start 3.125mg q12h; titrate to 25mg q12h",
      sideEffects:["Dizziness","Hypotension","Bradycardia","Weight gain","Fluid retention"],
      nursing:"Take with food. Titrate slowly. Monitor BP and HR. May mask hypoglycemia.",
      contraindications:"Severe bradycardia, cardiogenic shock, bronchial asthma, heart block" },
    { name:"Amlodipine", brand:"Norvasc", class:"Calcium Channel Blocker (Dihydropyridine)", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"HTN, chronic stable angina, vasospastic angina",route:"PO",
      dosage:"2.5‚Äì10mg once daily",
      sideEffects:["Peripheral edema","Headache","Flushing","Reflex tachycardia"],
      nursing:"Monitor BP and peripheral edema. Edema is due to vasodilation, not fluid overload ‚Äî diuretics usually not helpful.",
      contraindications:"Hypersensitivity, severe aortic stenosis" },
    { name:"Furosemide", brand:"Lasix", class:"Loop Diuretic", category:"Cardiac", icon:"üíß",
      indications:"Edema (HF, renal, hepatic), HTN, hypercalcemia, pulmonary edema",route:"PO, IV, IM",
      dosage:"PO: 20‚Äì80mg/day; IV: 20‚Äì80mg (may repeat q6-8h); max 600mg/day",
      sideEffects:["Hypokalemia","Hyponatremia","Dehydration","Hypotension","Ototoxicity (rapid IV)","Hyperglycemia"],
      nursing:"Monitor daily weights, I&O, electrolytes, BP. Give in morning. IV infuse no faster than 4mg/min. Potassium replacement often needed.",
      contraindications:"Anuria, sulfa allergy (relative), electrolyte depletion" },
    { name:"Spironolactone", brand:"Aldactone", class:"Potassium-Sparing Diuretic / Aldosterone Antagonist", category:"Cardiac", icon:"üíß",
      indications:"Heart failure, ascites, HTN, hyperaldosteronism",route:"PO",
      dosage:"25‚Äì50mg daily; HF: 12.5‚Äì25mg daily",
      sideEffects:["Hyperkalemia","Gynecomastia","Irregular periods","Dizziness"],
      nursing:"Monitor K+ levels closely. Avoid potassium supplements and NSAID use. Used in HF to improve survival.",
      contraindications:"Hyperkalemia, renal failure, Addison's disease, anuria" },
    { name:"Digoxin", brand:"Lanoxin", class:"Cardiac Glycoside", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"HF (with reduced EF), afib rate control",route:"PO, IV",
      dosage:"0.125‚Äì0.25mg daily; adjust for renal function. Therapeutic level: 0.5‚Äì2 ng/mL.",
      sideEffects:["Arrhythmias","Nausea/vomiting","Visual changes (yellow-green halos)","Fatigue","Bradycardia"],
      nursing:"Monitor HR (hold if <60). Check serum dig level, K+ (hypokalemia increases toxicity). Narrow therapeutic index. Antidote: Digibind.",
      contraindications:"Ventricular fibrillation, hypersensitivity", antidote:"Digoxin immune Fab (Digibind/DigiFab)" },
    { name:"Atorvastatin", brand:"Lipitor", class:"Statin (HMG-CoA Reductase Inhibitor)", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"Hyperlipidemia, CVD risk reduction",route:"PO",
      dosage:"10‚Äì80mg once daily (can take any time of day)",
      sideEffects:["Myopathy/rhabdomyolysis","Elevated LFTs","Headache","GI upset"],
      nursing:"Monitor lipid panel and LFTs. Report muscle pain (check CK). Avoid grapefruit juice. Teratogenic ‚Äî contraindicated in pregnancy.",
      contraindications:"Active liver disease, pregnancy, breastfeeding" },
    { name:"Warfarin", brand:"Coumadin", class:"Anticoagulant (Vitamin K Antagonist)", category:"Anticoagulant", icon:"ü©∏",
      indications:"DVT/PE treatment/prevention, afib, mechanical heart valves, stroke prevention",route:"PO",
      dosage:"Individualized by INR; typical 2‚Äì10mg/day. Target INR 2‚Äì3 (2.5‚Äì3.5 for mechanical valves).",
      sideEffects:["Bleeding","Bruising","Hair loss","Purple toe syndrome"],
      nursing:"Monitor INR. Consistent Vitamin K diet. Many drug interactions. Antidote: Vitamin K (phytonadione), FFP (emergency).",
      contraindications:"Active bleeding, pregnancy, severe hypertension, hemorrhagic stroke", antidote:"Vitamin K (phytonadione), FFP" },
    { name:"Heparin", brand:"Unfractionated Heparin", class:"Anticoagulant (Unfractionated)", category:"Anticoagulant", icon:"ü©∏",
      indications:"DVT/PE treatment, ACS, surgical prophylaxis, line patency",route:"IV, SubQ",
      dosage:"DVT/PE: weight-based IV protocol. Prophylaxis: 5000 units SubQ q8-12h.",
      sideEffects:["Bleeding","HIT (Heparin-Induced Thrombocytopenia)","Thrombosis (with HIT)"],
      nursing:"Monitor aPTT (therapeutic: 60‚Äì100s). Never give IM. Monitor platelet counts (HIT risk days 5‚Äì10). Antidote: Protamine sulfate.",
      contraindications:"Active bleeding, HIT history, severe thrombocytopenia", antidote:"Protamine sulfate" },
    { name:"Enoxaparin", brand:"Lovenox", class:"Anticoagulant (LMWH)", category:"Anticoagulant", icon:"ü©∏",
      indications:"DVT/PE treatment, prophylaxis, ACS",route:"SubQ",
      dosage:"Treatment: 1mg/kg SubQ q12h or 1.5mg/kg q24h. Prophylaxis: 30‚Äì40mg SubQ daily.",
      sideEffects:["Bleeding","Bruising at injection site","Thrombocytopenia (less HIT than UFH)"],
      nursing:"Administer in abdomen. Rotate sites. Cannot use anti-Xa levels routinely (preferred over aPTT). Renal dose adjustment needed.",
      contraindications:"Active bleeding, HIT, severe renal impairment (CrCl <30)", antidote:"Protamine sulfate (partial reversal)" },
    { name:"Aspirin", brand:"Bayer, Ecotrin", class:"Antiplatelet / NSAID", category:"Anticoagulant", icon:"ü©∏",
      indications:"Acute MI/stroke, antiplatelet (81mg), pain/fever (higher doses)",route:"PO",
      dosage:"Cardioprotection: 81mg daily. Acute MI: 325mg chewed immediately. Analgesia: 325‚Äì650mg q4-6h.",
      sideEffects:["GI bleeding","Tinnitus (toxicity)","Reye syndrome (children)","Allergic reactions"],
      nursing:"Give with food. Monitor for bleeding. Never use in children with viral illness. Antidote for OD: dialysis, activated charcoal.",
      contraindications:"Active bleeding, children with viral illness, 3rd trimester pregnancy (high dose), anticoagulant therapy (relative)" },
    { name:"Apixaban", brand:"Eliquis", class:"Anticoagulant (Factor Xa Inhibitor)", category:"Anticoagulant", icon:"ü©∏",
      indications:"DVT/PE treatment/prevention, afib stroke prevention, post-surgical prophylaxis",route:"PO",
      dosage:"A-fib: 5mg BID (2.5mg BID if 2 of 3: age ‚â•80, weight ‚â§60kg, Cr ‚â•1.5). DVT/PE: 10mg BID x7d then 5mg BID.",
      sideEffects:["Bleeding","Bruising"],
      nursing:"No routine coagulation monitoring needed. No antidote was available until Andexxa (andexanet alfa). Crush and mix with water for NG tube. Renal monitoring.",
      contraindications:"Active bleeding, mechanical heart valves", antidote:"Andexanet alfa (Andexxa)" },

    // ‚îÄ‚îÄ DIABETES ‚îÄ‚îÄ
    { name:"Metformin", brand:"Glucophage", class:"Antidiabetic ‚Äì Biguanide", category:"Antidiabetic", icon:"üç≠",
      indications:"Type 2 Diabetes Mellitus",route:"PO",
      dosage:"Initial 500mg BID with meals or 850mg daily; max 2550mg/day",
      sideEffects:["GI upset (nausea, diarrhea, metallic taste)","Lactic acidosis (rare, mainly with renal impairment)","B12 deficiency (long-term)"],
      nursing:"Give with meals to reduce GI side effects. Monitor renal function. Hold 48h before/after IV contrast dye. No hypoglycemia risk (monotherapy).",
      contraindications:"eGFR <30, acute illness/sepsis, IV contrast use, metabolic acidosis, excessive alcohol" },
    { name:"Glipizide", brand:"Glucotrol", class:"Antidiabetic ‚Äì Sulfonylurea", category:"Antidiabetic", icon:"üç≠",
      indications:"Type 2 Diabetes Mellitus",route:"PO",
      dosage:"2.5‚Äì20mg/day (IR) 30 min before meals; XL: 5‚Äì20mg daily with breakfast",
      sideEffects:["Hypoglycemia","Weight gain","GI upset"],
      nursing:"High risk for hypoglycemia. Monitor glucose. Give 30 min before meals. Instruct patient to eat after taking.",
      contraindications:"Type 1 DM, DKA, sulfa allergy, renal/hepatic failure" },
    { name:"Regular Insulin", brand:"Humulin R, Novolin R", class:"Insulin ‚Äì Short-acting", category:"Antidiabetic", icon:"üíâ",
      indications:"Type 1 & 2 DM, DKA, hyperkalemia (with dextrose)",route:"IV, SubQ, IM",
      dosage:"Variable; onset SubQ: 30 min, peak: 2‚Äì3h, duration: 6‚Äì8h. IV infusion for DKA/ICU.",
      sideEffects:["Hypoglycemia","Hypokalemia","Weight gain","Injection site lipodystrophy"],
      nursing:"Only insulin that can be given IV. Monitor glucose q1h when on drip. Have D50 ready. Rotate injection sites. Check for compatibility when mixing.",
      contraindications:"Hypoglycemia", antidote:"Dextrose (D50W IV or orange juice PO)" },
    { name:"Insulin Glargine", brand:"Lantus, Basaglar, Toujeo", class:"Insulin ‚Äì Long-acting (Basal)", category:"Antidiabetic", icon:"üíâ",
      indications:"Type 1 & 2 DM (basal coverage)",route:"SubQ only",
      dosage:"Once daily at same time; dose individualized; onset 1-2h, no peak, duration 20‚Äì24h",
      sideEffects:["Hypoglycemia","Injection site reactions","Weight gain"],
      nursing:"Give SubQ ONLY ‚Äî never IV. Do NOT mix with other insulins. Administer at same time daily. Lantus is clear (not cloudy like NPH).",
      contraindications:"Hypoglycemia, IV administration" },
    { name:"Insulin Lispro", brand:"Humalog, Admelog", class:"Insulin ‚Äì Rapid-acting", category:"Antidiabetic", icon:"üíâ",
      indications:"Prandial (mealtime) insulin coverage for Type 1 & 2 DM",route:"SubQ, IV (in selected settings)",
      dosage:"Given 0‚Äì15 min before meals or immediately after; onset 15 min, peak 30‚Äì90 min, duration 3‚Äì5h",
      sideEffects:["Hypoglycemia","Injection site reactions"],
      nursing:"Administer right before meals. If patient not eating, hold or reduce dose. Monitor glucose 1h post-meal. Can be mixed with NPH.",
      contraindications:"Hypoglycemia", antidote:"Dextrose (D50W IV or orange juice PO)" },
    { name:"Semaglutide", brand:"Ozempic (SubQ), Rybelsus (PO), Wegovy (weight loss)", class:"GLP-1 Receptor Agonist", category:"Antidiabetic", icon:"üç≠",
      indications:"Type 2 DM, cardiovascular risk reduction, obesity (Wegovy)",route:"SubQ weekly, PO daily",
      dosage:"SubQ: 0.25mg weekly x4wk then 0.5‚Äì2mg weekly. PO: 3‚Äì14mg daily.",
      sideEffects:["Nausea","Vomiting","Diarrhea","Pancreatitis","Thyroid C-cell tumors (rat data)"],
      nursing:"Give SubQ in abdomen, thigh, or upper arm. Rotate sites. Counsel on pancreatitis signs. Significant weight loss expected. Hold before surgeries.",
      contraindications:"Personal/family hx of medullary thyroid carcinoma, MEN type 2, pancreatitis" },

    // ‚îÄ‚îÄ RESPIRATORY ‚îÄ‚îÄ
    { name:"Albuterol", brand:"ProAir, Ventolin, Proventil", class:"Beta-2 Agonist Bronchodilator (SABA)", category:"Respiratory", icon:"ü´Å",
      indications:"Acute bronchospasm, asthma, COPD exacerbation, hyperkalemia (adjunct)",route:"Inhaled, Nebulized",
      dosage:"MDI: 2 puffs q4-6h PRN; Nebulizer: 2.5mg in 3mL NS q20min x3 (acute), then q1-4h",
      sideEffects:["Tachycardia","Tremor","Nervousness","Hypokalemia","Palpitations","Headache"],
      nursing:"Monitor HR and K+. Teach correct inhaler technique. Rinse mouth after. Onset: 5‚Äì15 min. Peak: 30‚Äì60 min.",
      contraindications:"Hypersensitivity to albuterol" },
    { name:"Salmeterol", brand:"Serevent", class:"Beta-2 Agonist (LABA)", category:"Respiratory", icon:"ü´Å",
      indications:"Maintenance of asthma & COPD (NOT for acute rescue)",route:"Inhaled",
      dosage:"1 inhalation (50mcg) BID; must use with ICS in asthma",
      sideEffects:["Tachycardia","Tremor","Paradoxical bronchospasm","Hypokalemia"],
      nursing:"NEVER use for acute rescue. Must be paired with ICS in asthma (boxed warning). Rinse mouth. Teach patient it is a maintenance medication.",
      contraindications:"Acute bronchospasm, monotherapy in asthma (without ICS)" },
    { name:"Ipratropium", brand:"Atrovent", class:"Anticholinergic Bronchodilator", category:"Respiratory", icon:"ü´Å",
      indications:"COPD maintenance, acute asthma (with albuterol), rhinorrhea",route:"Inhaled, Nebulized, Nasal spray",
      dosage:"MDI: 2 puffs TID-QID; Nebulizer: 0.5mg q6-8h",
      sideEffects:["Dry mouth","Constipation","Urinary retention","Blurred vision (if sprayed in eyes)","Tachycardia"],
      nursing:"Avoid spraying in eyes. Caution with BPH and narrow-angle glaucoma. Not for rescue ‚Äî slower onset than albuterol.",
      contraindications:"Hypersensitivity to atropine or ipratropium, peanut allergy (older formulations)" },
    { name:"Fluticasone", brand:"Flovent (ICS), Flonase (nasal)", class:"Corticosteroid (Inhaled)", category:"Respiratory", icon:"ü´Å",
      indications:"Asthma maintenance, allergic rhinitis",route:"Inhaled, Nasal",
      dosage:"Inhaled: 88‚Äì440mcg BID; Nasal: 2 sprays each nostril once daily",
      sideEffects:["Oral thrush (candidiasis)","Hoarseness","Adrenal suppression (high doses)"],
      nursing:"Rinse mouth and gargle after use to prevent thrush. Not a rescue medication. Monitor for adrenal suppression with long-term high-dose use.",
      contraindications:"Acute bronchospasm (not for rescue)" },
    { name:"Montelukast", brand:"Singulair", class:"Leukotriene Receptor Antagonist", category:"Respiratory", icon:"ü´Å",
      indications:"Asthma prophylaxis, seasonal allergic rhinitis, exercise-induced bronchoconstriction",route:"PO",
      dosage:"Adults: 10mg once daily in evening. Children: 5mg (6‚Äì14yr), 4mg granules (<5yr).",
      sideEffects:["Headache","GI upset","Neuropsychiatric effects (depression, suicidal thoughts ‚Äî boxed warning)"],
      nursing:"Take in evening. Counsel on neuropsychiatric side effects. Not for acute attacks.",
      contraindications:"Hypersensitivity; caution with neuropsychiatric history" },

    // ‚îÄ‚îÄ PSYCH / NEUROPSYCHIATRIC ‚îÄ‚îÄ
    { name:"Sertraline", brand:"Zoloft", class:"Antidepressant ‚Äì SSRI", category:"Psych", icon:"üß†",
      indications:"Depression, OCD, panic disorder, PTSD, social anxiety, PMDD",route:"PO",
      dosage:"50‚Äì200mg once daily (start 25‚Äì50mg, titrate q1‚Äì2wk)",
      sideEffects:["Nausea","Sexual dysfunction","Insomnia","Diarrhea","Weight changes","Increased suicidal ideation (young adults)"],
      nursing:"4‚Äì6 weeks for full effect. Monitor mood and suicidality especially early treatment. Do not stop abruptly (taper). Avoid MAOIs.",
      contraindications:"MAOIs within 14 days, pimozide, linezolid" },
    { name:"Fluoxetine", brand:"Prozac, Sarafem", class:"Antidepressant ‚Äì SSRI", category:"Psych", icon:"üß†",
      indications:"Depression, OCD, bulimia, panic disorder, PMDD",route:"PO",
      dosage:"10‚Äì80mg once daily (start 20mg; can give weekly 90mg formulation for maintenance)",
      sideEffects:["Insomnia","Anxiety","Sexual dysfunction","Headache","Weight changes"],
      nursing:"Longest half-life of SSRIs ‚Äî less discontinuation syndrome. Weekly dosing option for compliance. Monitor suicidality in youth.",
      contraindications:"MAOIs within 14 days (5 weeks if transitioning FROM fluoxetine), thioridazine, pimozide" },
    { name:"Lorazepam", brand:"Ativan", class:"Benzodiazepine (Schedule IV)", category:"Psych", icon:"üß†",
      indications:"Anxiety, seizure (status epilepticus), alcohol withdrawal, procedure sedation",route:"PO, IV, IM",
      dosage:"Anxiety: 0.5‚Äì2mg q6-8h. Status epilepticus: 0.05‚Äì0.1mg/kg IV (max 4mg).",
      sideEffects:["CNS depression/sedation","Respiratory depression","Amnesia","Dependence/withdrawal"],
      nursing:"High fall risk ‚Äî bed in low position, call light in reach. Respiratory precautions. Do not stop abruptly (withdrawal seizure risk). Antidote: flumazenil.",
      contraindications:"Acute narrow-angle glaucoma, severe respiratory depression, sleep apnea", antidote:"Flumazenil (Romazicon)" },
    { name:"Haloperidol", brand:"Haldol", class:"Antipsychotic ‚Äì Typical (Butyrophenone)", category:"Psych", icon:"üß†",
      indications:"Schizophrenia, acute psychosis, agitation, Tourette syndrome, delirium (ICU)",route:"PO, IM, IV (IV for ICU only)",
      dosage:"Oral: 0.5‚Äì20mg/day. IM (acute): 5mg q1h PRN. IV in ICU agitation: 0.5‚Äì10mg.",
      sideEffects:["EPS (dystonia, akathisia, pseudoparkinsonism)","Tardive dyskinesia","QT prolongation","Neuroleptic Malignant Syndrome (NMS)","Sedation"],
      nursing:"Monitor for EPS (abnormal movements). NMS is life-threatening ‚Äî stop immediately if suspected. ECG monitoring with IV use. Restrain-reduction alternative for agitation.",
      contraindications:"Parkinson disease, CNS depression, QT prolongation" },
    { name:"Quetiapine", brand:"Seroquel", class:"Antipsychotic ‚Äì Atypical", category:"Psych", icon:"üß†",
      indications:"Schizophrenia, bipolar disorder, MDD (adjunct), insomnia (off-label low dose)",route:"PO",
      dosage:"Psychosis: 150‚Äì750mg/day divided. Bipolar depression: 50‚Äì300mg/day.",
      sideEffects:["Sedation","Weight gain","Metabolic syndrome","Orthostatic hypotension","QT prolongation","EPS (less than typical)"],
      nursing:"Monitor weight, glucose, lipids. High fall risk due to sedation/orthostasis. Take with food. Taper when discontinuing.",
      contraindications:"Dementia-related psychosis (boxed warning ‚Äì increased mortality)" },
    { name:"Lithium", brand:"Lithobid, Eskalith", class:"Mood Stabilizer", category:"Psych", icon:"üß†",
      indications:"Bipolar disorder (acute mania and maintenance)",route:"PO",
      dosage:"Start 300mg TID; adjust by levels. Therapeutic: 0.6‚Äì1.2 mEq/L (maintenance); 0.8‚Äì1.2 (acute).",
      sideEffects:["Tremor","Polyuria/polydipsia","Weight gain","GI upset","Hypothyroidism","Nephrogenic DI","Toxicity (narrow index)"],
      nursing:"Narrow therapeutic index. Monitor serum levels. Maintain adequate Na+ and fluid intake. Signs of toxicity: coarse tremor, confusion, ataxia, seizures.",
      contraindications:"Renal failure, severe dehydration, low-sodium diet, pregnancy (Ebstein's anomaly risk)" },

    // ‚îÄ‚îÄ GI ‚îÄ‚îÄ
    { name:"Omeprazole", brand:"Prilosec", class:"Proton Pump Inhibitor (PPI)", category:"GI", icon:"ü´É",
      indications:"GERD, peptic ulcer, Zollinger-Ellison, H. pylori (combo), NSAID-induced ulcer prevention",route:"PO, IV",
      dosage:"20‚Äì40mg before first meal daily; H. pylori: 20mg BID x10-14d (with antibiotics)",
      sideEffects:["Headache","Diarrhea","Magnesium deficiency (long-term)","C. diff (long-term)","Bone fractures (long-term high-dose)"],
      nursing:"Take 30‚Äì60 min before first meal. Long-term use: monitor Mg2+, B12, bone density. Avoid prolonged use without indication.",
      contraindications:"Hypersensitivity to PPIs" },
    { name:"Ondansetron", brand:"Zofran", class:"Antiemetic ‚Äì 5-HT3 Receptor Antagonist", category:"GI", icon:"ü´É",
      indications:"Chemotherapy-induced N&V, PONV, pregnancy hyperemesis, gastroenteritis",route:"PO, IV, IM",
      dosage:"4‚Äì8mg q6-8h PO or IV; chemo: 8mg PO BID or 0.15mg/kg IV before chemo",
      sideEffects:["Headache","Constipation","QT prolongation","Serotonin syndrome (with other serotonergics)"],
      nursing:"Monitor ECG in at-risk patients. Give IV slowly. ODT (oral dissolving tab) do not swallow whole ‚Äî let dissolve.",
      contraindications:"Hypersensitivity, congenital long QT syndrome, apomorphine" },
    { name:"Metoclopramide", brand:"Reglan", class:"Prokinetic / Antiemetic ‚Äì Dopamine Antagonist", category:"GI", icon:"ü´É",
      indications:"GERD, gastroparesis, N&V, post-op ileus, hiccups",route:"PO, IV, IM",
      dosage:"5‚Äì10mg TID-QID before meals and at bedtime",
      sideEffects:["Tardive dyskinesia (risk with >12wks use)","EPS","Restlessness/akathisia","Drowsiness"],
      nursing:"Limit to <12 weeks. Monitor for involuntary movements (tardive dyskinesia ‚Äî may be irreversible). IV slowly.",
      contraindications:"GI obstruction or perforation, Parkinson disease, pheochromocytoma" },
    { name:"Loperamide", brand:"Imodium", class:"Antidiarrheal ‚Äì Opioid Agonist (local)", category:"GI", icon:"ü´É",
      indications:"Acute/chronic diarrhea, high-output ileostomy",route:"PO",
      dosage:"4mg initially then 2mg after each loose stool; max 16mg/day",
      sideEffects:["Constipation","Abdominal cramping","Dizziness"],
      nursing:"Not for diarrhea with fever or bloody stools (may worsen infectious colitis). Adequate hydration essential. Does not cross BBB at therapeutic doses.",
      contraindications:"Acute dysentery, C. diff colitis, ulcerative colitis exacerbation" },
    { name:"Polyethylene Glycol", brand:"MiraLAX, GoLYTELY (bowel prep)", class:"Osmotic Laxative", category:"GI", icon:"ü´É",
      indications:"Constipation, bowel prep for colonoscopy",route:"PO",
      dosage:"Constipation: 17g in 8oz water once daily. GoLYTELY (prep): 4L over 3-4h.",
      sideEffects:["Bloating","Nausea","Cramping","Electrolyte imbalance (high-volume prep)"],
      nursing:"Adequate fluid intake essential. Monitor electrolytes for high-volume bowel prep use.",
      contraindications:"Bowel obstruction, known hypersensitivity" },

    // ‚îÄ‚îÄ NEUROLOGICAL ‚îÄ‚îÄ
    { name:"Phenytoin", brand:"Dilantin", class:"Anticonvulsant ‚Äì Hydantoin", category:"Neuro", icon:"üß†",
      indications:"Tonic-clonic seizures, status epilepticus, trigeminal neuralgia (off-label)",route:"PO, IV",
      dosage:"Loading: 15‚Äì20mg/kg IV at max 50mg/min; Maintenance: 300‚Äì400mg/day.",
      sideEffects:["Gingival hyperplasia","Nystagmus","Ataxia","Sedation","Cardiac arrhythmia (rapid IV)","Purple glove syndrome","Teratogenic"],
      nursing:"Infuse IV no faster than 50mg/min (cardiac monitoring). Must use NS only ‚Äî D5W causes precipitation. Therapeutic level: 10‚Äì20 mcg/mL (free: 1‚Äì2). Dental hygiene education.",
      contraindications:"Sinus bradycardia, heart block, pregnancy (teratogenic), porphyria" },
    { name:"Levetiracetam", brand:"Keppra", class:"Anticonvulsant", category:"Neuro", icon:"üß†",
      indications:"Partial onset seizures, myoclonic seizures, generalized tonic-clonic",route:"PO, IV",
      dosage:"500‚Äì3000mg/day divided BID; may start at 500mg BID and titrate",
      sideEffects:["Irritability/behavioral changes (Keppra rage)","Somnolence","Fatigue","Dizziness"],
      nursing:"Monitor mood and behavior. Fewer drug interactions than phenytoin. Renal dose adjustment. No lab monitoring routinely needed.",
      contraindications:"Hypersensitivity" },
    { name:"Gabapentin", brand:"Neurontin", class:"Anticonvulsant / Neuropathic Pain Agent", category:"Neuro", icon:"üß†",
      indications:"Partial seizures, neuropathic pain (PHN, diabetic neuropathy), fibromyalgia, restless legs",route:"PO",
      dosage:"Seizures: 300‚Äì1200mg TID. Pain: 100‚Äì600mg TID.",
      sideEffects:["Somnolence","Dizziness","Ataxia","Edema","Weight gain","Respiratory depression (with CNS depressants)"],
      nursing:"Reduce dose in renal impairment. High fall risk. Abuse potential ‚Äî monitor. Do not stop abruptly.",
      contraindications:"Hypersensitivity; caution with opioids (additive respiratory depression)" },
    { name:"Sumatriptan", brand:"Imitrex", class:"Antimigraine ‚Äì Triptan (5-HT1B/1D Agonist)", category:"Neuro", icon:"üß†",
      indications:"Acute migraine treatment, cluster headaches",route:"PO, SubQ, Nasal spray",
      dosage:"PO: 25‚Äì100mg; SubQ: 6mg (fastest onset); Nasal: 5‚Äì20mg; repeat in 2h if needed.",
      sideEffects:["Chest tightness/pressure","Tingling","Warm/flushing sensations","Dizziness","Serotonin syndrome (with serotonergics)"],
      nursing:"For acute attack only ‚Äî not preventive. Contraindicated in cardiovascular disease. Use early in migraine.",
      contraindications:"CAD, uncontrolled HTN, hemiplegic migraine, MAOIs within 14 days" },
    { name:"Donepezil", brand:"Aricept", class:"Cholinesterase Inhibitor", category:"Neuro", icon:"üß†",
      indications:"Alzheimer disease (mild-moderate-severe), dementia",route:"PO",
      dosage:"5mg once daily at bedtime; may increase to 10‚Äì23mg after 4‚Äì6 weeks",
      sideEffects:["Nausea","Diarrhea","Insomnia","Bradycardia","Muscle cramps","GI bleeding"],
      nursing:"Give at bedtime to minimize GI side effects. Monitor HR. Does not cure ‚Äî slows progression. Caution with NSAIDs (increased GI bleed risk).",
      contraindications:"Hypersensitivity to piperidine derivatives; caution with sick sinus syndrome" },

    // ‚îÄ‚îÄ ENDOCRINE ‚îÄ‚îÄ
    { name:"Levothyroxine", brand:"Synthroid, Levoxyl", class:"Thyroid Hormone Replacement", category:"Endocrine", icon:"ü¶ã",
      indications:"Hypothyroidism, thyroid cancer suppression",route:"PO, IV",
      dosage:"1.6 mcg/kg/day PO; start low (25‚Äì50mcg) in elderly/cardiac patients. IV dose = 50% of PO.",
      sideEffects:["Tachycardia","Palpitations","Tremor","Insomnia","Weight loss","Osteoporosis (long-term overdose)"],
      nursing:"Take on empty stomach 30‚Äì60 min before breakfast. Do not take within 4h of calcium, iron, antacids. Monitor TSH (primary parameter). Consistent brand matters.",
      contraindications:"Untreated adrenal insufficiency, acute MI (relative), thyrotoxicosis" },
    { name:"Prednisone", brand:"Deltasone", class:"Corticosteroid (Oral)", category:"Steroid", icon:"üíä",
      indications:"Inflammation, autoimmune disorders, asthma exacerbation, adrenal insufficiency",route:"PO",
      dosage:"5‚Äì60mg daily (widely variable by indication)",
      sideEffects:["Hyperglycemia","Weight gain/cushingoid features","Mood changes","Immunosuppression","Osteoporosis","Hypokalemia","Adrenal suppression"],
      nursing:"Give with food. Do NOT stop abruptly (adrenal crisis risk ‚Äî taper gradually). Monitor glucose, BP, and for infection signs.",
      contraindications:"Systemic fungal infections, live vaccines during therapy" },
    { name:"Methylprednisolone", brand:"Solu-Medrol", class:"Corticosteroid (IV)", category:"Steroid", icon:"üíä",
      indications:"Acute asthma, COPD exacerbation, spinal cord injury (controversial), autoimmune flares",route:"IV, IM, PO",
      dosage:"IV: 40‚Äì250mg q4-6h; pulse: 500‚Äì1000mg/day for severe conditions",
      sideEffects:["Hyperglycemia","Insomnia","GI upset","Fluid retention","Immunosuppression"],
      nursing:"Monitor glucose closely (often significant hyperglycemia). Monitor for GI bleeding. Avoid live vaccines.",
      contraindications:"Systemic fungal infection, live vaccines" },
    { name:"Dexamethasone", brand:"Decadron", class:"Corticosteroid (Long-acting)", category:"Steroid", icon:"üíä",
      indications:"Cerebral edema, N&V prophylaxis (chemo), adrenal insufficiency testing, croup, COVID-19 (O2-dependent)",route:"PO, IV, IM",
      dosage:"Edema: 10mg IV then 4mg q6h. N&V: 4‚Äì8mg IV. Diagnostic suppression test: 1mg.",
      sideEffects:["Hyperglycemia","Immunosuppression","GI irritation","Insomnia","Adrenal suppression"],
      nursing:"No mineralocorticoid activity. Monitor glucose. Most potent anti-inflammatory of common corticosteroids.",
      contraindications:"Systemic fungal infections, active untreated infections" },
    { name:"Hydrocortisone", brand:"Solu-Cortef", class:"Corticosteroid (Has Mineralocorticoid Activity)", category:"Steroid", icon:"üíä",
      indications:"Adrenal crisis/insufficiency replacement, severe allergic reactions, shock, status asthmaticus",route:"IV, IM, PO, topical",
      dosage:"Adrenal crisis: 100mg IV q8h. Stress dosing: 50mg q6‚Äì8h.",
      sideEffects:["Fluid and sodium retention","Hyperglycemia","GI upset","Hypokalemia"],
      nursing:"Has both glucocorticoid and mineralocorticoid effects. Monitor electrolytes and glucose. For adrenal crisis replacement.",
      contraindications:"Systemic fungal infections" },

    // ‚îÄ‚îÄ ADDITIONAL IMPORTANT MEDS ‚îÄ‚îÄ
    { name:"Naloxone", brand:"Narcan", class:"Opioid Antagonist", category:"Analgesic", icon:"üö®",
      indications:"Opioid overdose reversal (respiratory depression), opioid-induced pruritus",route:"IV, IM, SubQ, Intranasal",
      dosage:"Overdose: 0.4‚Äì2mg IV/IM q2-3min; Intranasal: 2‚Äì4mg per nostril. Repeat if no response.",
      sideEffects:["Acute opioid withdrawal (N/V, tachycardia, hypertension)","Resedation (short duration)"],
      nursing:"Very short-acting (30‚Äì90 min). May wear off before opioid ‚Äî monitor closely, may need repeat doses or infusion. OPIOID ANTIDOTE.",
      contraindications:"Hypersensitivity to naloxone", antidote:"N/A ‚Äî it IS the antidote" },
    { name:"Flumazenil", brand:"Romazicon", class:"Benzodiazepine Antagonist", category:"Psych", icon:"üö®",
      indications:"Benzodiazepine overdose reversal, procedural sedation reversal",route:"IV",
      dosage:"0.2mg IV over 15 sec; repeat 0.2mg q1min; max 1mg total.",
      sideEffects:["Seizures (in benzo-dependent patients)","Resedation","Dizziness","Nausea"],
      nursing:"Short-acting ‚Äî resedation can occur. Do NOT use in patients who are benzo-dependent (precipitates severe withdrawal/seizures). BENZODIAZEPINE ANTIDOTE.",
      contraindications:"Benzo-dependent patients, overdose of mixed drugs including TCAs", antidote:"N/A ‚Äî it IS the antidote" },
    { name:"Atropine", brand:"AtroPen", class:"Anticholinergic / Parasympatholytic", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"Symptomatic bradycardia, organophosphate poisoning (large doses), pre-anesthesia, reduce secretions",route:"IV, IM, ET",
      dosage:"Bradycardia: 0.5mg IV q3-5min; max 3mg. Organophosphate: 2‚Äì4mg IV q5-10min until secretions dry.",
      sideEffects:["Tachycardia","Dry mouth","Urinary retention","Constipation","Blurred vision","Confusion (elderly)"],
      nursing:"SLUDGE = Organophosphate toxicity symptoms (Salivation, Lacrimation, Urination, Defecation, GI distress, Emesis). Antidote: atropine + pralidoxime. Min dose 0.5mg ‚Äî less can paradoxically worsen bradycardia.",
      contraindications:"Narrow-angle glaucoma, tachycardia, BPH, ileus, myasthenia gravis" },
    { name:"Potassium Chloride", brand:"Klor-Con, K-Dur", class:"Electrolyte Supplement", category:"Cardiac", icon:"‚öóÔ∏è",
      indications:"Hypokalemia, cardiac arrhythmia prevention, diuretic-induced K+ loss",route:"PO, IV",
      dosage:"PO: 20‚Äì80mEq/day divided. IV: max 10‚Äì20mEq/hr via central line (never undiluted).",
      sideEffects:["GI upset/nausea (PO)","Phlebitis (peripheral IV)","Cardiac arrest (if IV too rapid)"],
      nursing:"NEVER give undiluted IV push ‚Äî FATAL. Max IV rate 10mEq/hr peripheral, 20mEq/hr central. Monitor ECG during IV infusion. PO with food or water.",
      contraindications:"Hyperkalemia, renal failure, ACE inhibitor/K-sparing diuretic combo (caution)" },
    { name:"Magnesium Sulfate", brand:"MgSO4", class:"Electrolyte / Anticonvulsant / Tocolytic", category:"Cardiac", icon:"‚öóÔ∏è",
      indications:"Eclampsia/preeclampsia (seizure prevention & treatment), hypomagnesemia, torsades de pointes, preterm labor (tocolytic)",route:"IV, IM",
      dosage:"Eclampsia: 4‚Äì6g IV load over 20 min, then 1‚Äì2g/hr infusion. Hypomagnesemia: 1‚Äì2g IV over 1 hour.",
      sideEffects:["Hypotension","Respiratory depression (toxicity)","Loss of DTRs (early toxicity sign)","Flushing","Cardiac arrest (overdose)"],
      nursing:"Monitor: DTRs (first sign of toxicity = loss of reflexes), RR (hold if <12), BP, urine output. Have calcium gluconate (antidote) at bedside. Therapeutic level 4‚Äì7 mEq/L.",
      contraindications:"Hypermagnesemia, heart block, renal failure", antidote:"Calcium gluconate" },
    { name:"Adenosine", brand:"Adenocard", class:"Antiarrhythmic ‚Äì Class Misc.", category:"Cardiac", icon:"‚ö°",
      indications:"Acute SVT (paroxysmal supraventricular tachycardia)",route:"Rapid IV push",
      dosage:"6mg rapid IV push; if no response in 1‚Äì2 min, 12mg; may repeat 12mg once.",
      sideEffects:["Chest pain/pressure","Dyspnea","Brief asystole (normal!)","Flushing","Headache"],
      nursing:"Give as FAST IV push followed immediately by 20mL NS flush. Warn patient of uncomfortable chest pressure. Extremely short half-life (~10 sec). Monitor ECG throughout.",
      contraindications:"2nd/3rd degree AV block, sick sinus syndrome, WPW, theophylline use (reduces effect)" },
    { name:"Amiodarone", brand:"Cordarone, Pacerone", class:"Antiarrhythmic ‚Äì Class III", category:"Cardiac", icon:"‚ö°",
      indications:"Ventricular fibrillation, pulseless VT (ACLS), persistent afib, SVT",route:"IV, PO",
      dosage:"VF/pulseless VT (ACLS): 300mg IV push; maintenance: 150mg IV over 10 min then infusion. PO: 200‚Äì400mg/day.",
      sideEffects:["Pulmonary toxicity","Thyroid dysfunction (hypo or hyper)","Hepatotoxicity","Photosensitivity (blue-gray skin)","Corneal deposits","Peripheral neuropathy"],
      nursing:"Multiple organ toxicity profile. Monitor LFTs, TFTs, PFTs, vision, skin. Check for drug interactions (many ‚Äî inhibits CYP enzymes). Use sunscreen.",
      contraindications:"2nd/3rd degree heart block, sinus bradycardia, iodine allergy, pregnancy" },
    { name:"Labetalol", brand:"Trandate, Normodyne", class:"Alpha/Beta Blocker", category:"Cardiac", icon:"‚ù§Ô∏è",
      indications:"Hypertensive emergency, pregnancy-related HTN (safe in OB), HTN",route:"PO, IV",
      dosage:"HTN emergency: 20mg IV bolus, may repeat 40‚Äì80mg q10min; max 300mg. Infusion: 0.5‚Äì2mg/min.",
      sideEffects:["Hypotension","Bradycardia","Bronchospasm","Dizziness"],
      nursing:"Monitor BP and HR continuously with IV. Patient must remain supine during and for 3h after IV (postural hypotension). Drug of choice in hypertensive emergency in pregnancy.",
      contraindications:"Severe bradycardia, heart block, decompensated HF, bronchospasm/asthma" },
    { name:"Nitroglycerine", brand:"Nitrostat, NitroBid, Nitro-Dur", class:"Vasodilator (Organic Nitrate)", category:"Cardiac", icon:"üíî",
      indications:"Angina pectoris, acute MI, HTN emergency, acute HF with pulmonary edema",route:"SL, IV, Topical, Transdermal",
      dosage:"SL: 0.3‚Äì0.4mg q5min x3; IV: 5‚Äì200mcg/min; Patch: 0.2‚Äì0.8mg/hr",
      sideEffects:["Hypotension","Headache","Dizziness","Reflex tachycardia","Tolerance (continuous use)"],
      nursing:"SL: Patient should be sitting. Call MD if no relief after 3 doses. IV in glass bottle only (plastic absorbs it). Remove patch before defibrillation. Tolerance: nitrate-free period 10-12h/day.",
      contraindications:"Hypotension (SBP <90), recent PDE-5 inhibitor (sildenafil/Viagra) use, increased ICP" },
    { name:"Clopidogrel", brand:"Plavix", class:"Antiplatelet ‚Äì P2Y12 Inhibitor", category:"Anticoagulant", icon:"ü©∏",
      indications:"ACS, recent MI/stroke, PCI with stent (with aspirin), peripheral arterial disease",route:"PO",
      dosage:"75mg once daily; ACS loading: 300‚Äì600mg",
      sideEffects:["Bleeding","Bruising","GI upset","TTP (rare but serious)"],
      nursing:"Dual antiplatelet with aspirin = higher bleeding risk. Hold 5‚Äì7 days before surgery. Omeprazole may reduce efficacy (CYP2C19 interaction).",
      contraindications:"Active pathological bleeding, peptic ulcer; caution with PPIs" },
    { name:"Propofol", brand:"Diprivan", class:"General Anesthetic / Sedative-Hypnotic", category:"Neuro", icon:"üíâ",
      indications:"ICU sedation, procedural sedation, induction/maintenance of anesthesia",route:"IV only",
      dosage:"ICU sedation: 5‚Äì50 mcg/kg/min infusion. Procedural: 100‚Äì200mg IV induction.",
      sideEffects:["Hypotension","Pain on injection","Hypertriglyceridemia","Propofol Infusion Syndrome (rare, high dose >5mg/kg/hr)"],
      nursing:"Contains soybean oil and egg lecithin ‚Äî check allergies. Single-use vials ‚Äî risk of contamination. Monitor triglycerides with prolonged use. Pain with injection can be reduced by pre-treating vein with lidocaine.",
      contraindications:"Egg/soybean/sulfite allergy, allergy to propofol" },
    { name:"Dextrose 50% (D50W)", brand:"D50", class:"Hypoglycemia Treatment / Carbohydrate", category:"Antidiabetic", icon:"üç≠",
      indications:"Severe hypoglycemia (glucose <70 with altered consciousness)",route:"IV push",
      dosage:"25‚Äì50mL (12.5‚Äì25g dextrose) IV push; repeat if needed",
      sideEffects:["Hyperglycemia (rebound)","Phlebitis (vesicant)","Fluid overload"],
      nursing:"Vesicant ‚Äî give IV through large vein or central line. Verify blood glucose before and after administration. Recheck glucose in 15 min. Identify and address underlying cause.",
      contraindications:"Hyperglycemia, known allergy" },
    { name:"Famotidine", brand:"Pepcid", class:"H2 Receptor Antagonist", category:"GI", icon:"ü´É",
      indications:"GERD, peptic ulcer, stress ulcer prophylaxis, Zollinger-Ellison",route:"PO, IV",
      dosage:"20‚Äì40mg PO once or twice daily; IV: 20mg q12h",
      sideEffects:["Headache","Dizziness","Constipation or diarrhea"],
      nursing:"Less effective than PPIs but lower long-term side effect profile. Onset: 1h, duration: 10‚Äì12h. Reduce dose in renal impairment.",
      contraindications:"Hypersensitivity to H2 blockers" },
    { name:"Acetylcysteine (N-acetylcysteine)", brand:"Mucomyst, Acetadote", class:"Antidote / Mucolytic", category:"Analgesic", icon:"üö®",
      indications:"Acetaminophen overdose antidote, contrast dye protection, mucolytic (nebulized)",route:"IV, PO",
      dosage:"IV: 150mg/kg over 60 min (loading), then 50mg/kg over 4h, then 100mg/kg over 16h. PO: 140mg/kg loading then 70mg/kg q4h x17 doses.",
      sideEffects:["Anaphylactoid reaction (IV)","Nausea/vomiting","Rash"],
      nursing:"Most effective within 8 hours of acetaminophen ingestion. IV anaphylactoid reaction ‚Äî slow infusion and treat symptomatically. PO has sulfurous odor ‚Äî can give with juice.",
      contraindications:"Hypersensitivity (relative)", antidote:"N/A ‚Äî it IS the antidote for acetaminophen" },
  ];

  // Category tag mapping for filtering
  const catMap = {
    'Analgesic': ['Analgesic'],
    'Antibiotic': ['Antibiotic'],
    'Anticoagulant': ['Anticoagulant'],
    'Cardiac': ['Cardiac'],
    'Antidiabetic': ['Antidiabetic'],
    'Respiratory': ['Respiratory'],
    'Psych': ['Psych'],
    'GI': ['GI'],
    'Neuro': ['Neuro'],
    'Endocrine': ['Endocrine'],
    'Steroid': ['Steroid']
  };

  document.getElementById('medCountBadge').innerText = medications.length + ' Meds';

  // CONFETTI
  const canvas = document.getElementById('confetti-canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  let pieces = [];

  function Confetti(x,y){
    this.x=x; this.y=y; this.size=Math.random()*6+4;
    this.speedY=Math.random()*3+2; this.speedX=Math.random()*2-1;
    this.color=['#2563eb','#7c3aed','#dc2626','#16a34a','#d97706'][Math.floor(Math.random()*5)];
    this.rotation=Math.random()*360; this.rotSpeed=Math.random()*10-5;
  }
  Confetti.prototype.update=function(){this.y+=this.speedY; this.x+=this.speedX; this.rotation+=this.rotSpeed; if(this.y>canvas.height){this.y=-10;this.x=Math.random()*canvas.width;}};
  Confetti.prototype.draw=function(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rotation*Math.PI/180);ctx.fillStyle=this.color;ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size);ctx.restore();};
  function animateConfetti(){ctx.clearRect(0,0,canvas.width,canvas.height);pieces.forEach(p=>{p.update();p.draw();});if(pieces.length>0)requestAnimationFrame(animateConfetti);}
  function showConfetti(){pieces=[];for(let i=0;i<100;i++)pieces.push(new Confetti(Math.random()*canvas.width,Math.random()*canvas.height-canvas.height));animateConfetti();setTimeout(()=>{pieces=[];},5000);}

  // TASKS
  function saveTasks(){ localStorage.setItem(TASKS_KEY,JSON.stringify(tasks)); }
  function addTask(){
    var text=document.getElementById('taskInput').value.trim();
    var subject=document.getElementById('taskSubject').value;
    var priority=document.getElementById('taskPriority').value;
    var date=document.getElementById('taskDate').value;
    if(!text||!date){alert('Please enter task description and date');return;}
    tasks.push({text,subject,priority,date,done:false,id:Date.now()});
    saveTasks(); render(); renderCalendar();
    document.getElementById('taskInput').value='';
    document.getElementById('taskDate').valueAsDate=new Date();
  }
  function toggleTask(i){tasks[i].done=!tasks[i].done;saveTasks();render();if(tasks[i].done)showConfetti();}
  function removeTask(i){if(confirm('Delete this task?')){tasks.splice(i,1);saveTasks();render();renderCalendar();}}
  function filterTasks(f){currentFilter=f;document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));document.querySelector('.filter-tab[data-filter="'+f+'"]').classList.add('active');render();}
  function getFilteredTasks(){
    var now=new Date(),today=now.toISOString().split('T')[0];
    var wk=new Date(now.getTime()+7*864e5).toISOString().split('T')[0];
    if(currentFilter==='today')return tasks.filter(t=>t.date===today);
    if(currentFilter==='week')return tasks.filter(t=>t.date>=today&&t.date<=wk);
    return tasks;
  }
  function formatDate(ds){var p=ds.split('-');return new Date(+p[0],+p[1]-1,+p[2]).toLocaleDateString('en-US',{month:'short',day:'numeric'});}
  function render(){
    var ft=getFilteredTasks(),c=document.getElementById('taskList');
    if(!ft.length){c.innerHTML='<div class="empty-state">No tasks yet</div>';updateStats();return;}
    c.innerHTML=ft.map(task=>{var oi=tasks.indexOf(task);return `<div class="task-item ${task.done?'done':''} priority-${task.priority}"><div class="task-checkbox ${task.done?'checked':''}" data-action="toggle" data-index="${oi}">${task.done?'‚úì':''}</div><div class="task-content"><div class="task-text">${task.text}</div><div class="task-meta"><span>${task.subject}</span><span>${task.priority.toUpperCase()}</span><span>${formatDate(task.date)}</span></div></div><div class="task-actions"><button data-action="remove" data-index="${oi}">üóëÔ∏è</button></div></div>`;}).join('');
    updateStats();
  }
  function updateStats(){
    var now=new Date(),today=now.toISOString().split('T')[0];
    var wk=new Date(now.getTime()+7*864e5).toISOString().split('T')[0];
    document.getElementById('weekTaskCount').innerText=tasks.filter(t=>t.date>=today&&t.date<=wk).length;
    document.getElementById('completedCount').innerText=tasks.filter(t=>t.date===today&&t.done).length;
  }

  // TIMER
  function updateTimerDisplay(){var m=Math.floor(timerSeconds/60),s=timerSeconds%60;document.getElementById('timerDisplay').innerText=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');}
  function startTimer(){if(timerInterval)return;timerInterval=setInterval(()=>{if(timerSeconds>0){timerSeconds--;updateTimerDisplay();}else{pauseTimer();alert('‚è∞ Timer finished! Great work!');showConfetti();}},1000);}
  function pauseTimer(){if(timerInterval){clearInterval(timerInterval);timerInterval=null;}}
  function setTimerPreset(min,btn){pauseTimer();timerPresetMinutes=min;timerSeconds=min*60;updateTimerDisplay();localStorage.setItem(TIMER_PRESET_KEY,min);document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');}
  function setCustomTimer(){var min=parseInt(document.getElementById('customMinutes').value);if(min&&min>0&&min<=180){pauseTimer();timerPresetMinutes=min;timerSeconds=min*60;updateTimerDisplay();localStorage.setItem(TIMER_PRESET_KEY,min);document.getElementById('customMinutes').value='';document.querySelectorAll('.preset-btn').forEach(b=>b.classList.remove('active'));}}
  function resetTimer(){pauseTimer();timerSeconds=timerPresetMinutes*60;updateTimerDisplay();}

  // CALCULATORS
  function calculate(){var o=parseFloat(document.getElementById('ordered').value),a=parseFloat(document.getElementById('available').value),v=parseFloat(document.getElementById('volume').value);if(!o||!a||!v){document.getElementById('doseOutput').innerHTML='<div class="calc-result" style="background:rgba(220,38,38,0.1);color:var(--danger);">Please fill in all fields</div>';return;}document.getElementById('doseOutput').innerHTML='<div class="calc-result">üíâ Administer '+((o/a)*v).toFixed(2)+' mL</div>';}
  function calculateIV(){var vol=parseFloat(document.getElementById('ivVolume').value),time=parseFloat(document.getElementById('ivTime').value),df=parseFloat(document.getElementById('dropFactor').value);if(!vol||!time||!df){document.getElementById('ivOutput').innerHTML='<div class="calc-result" style="background:rgba(220,38,38,0.1);color:var(--danger);">Please fill in all fields</div>';return;}document.getElementById('ivOutput').innerHTML='<div class="calc-result">üíß Flow Rate: '+(vol/time).toFixed(1)+' mL/hr<br>'+((vol*df)/(time*60)).toFixed(0)+' gtts/min</div>';}

  // ======================================================
  // ENHANCED MEDICATION SEARCH LOGIC
  // ======================================================
  function highlight(str, query) {
    if (!query) return str;
    var escaped = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    return str.replace(new RegExp('(' + escaped + ')', 'gi'), '<mark>$1</mark>');
  }

  function fuzzyScore(text, query) {
    text = text.toLowerCase(); query = query.toLowerCase();
    if (text.includes(query)) return 100;
    // Check word starts
    var words = text.split(/[\s,\-\/()]+/);
    for (var i = 0; i < words.length; i++) {
      if (words[i].startsWith(query)) return 80;
    }
    // Check individual chars (fuzzy)
    var qi = 0, score = 0;
    for (var ti = 0; ti < text.length && qi < query.length; ti++) {
      if (text[ti] === query[qi]) { score++; qi++; }
    }
    if (qi < query.length) return 0; // Didn't match all chars
    return Math.round((score / query.length) * 40);
  }

  function getMedMatchScore(med, query) {
    if (!query) return 1;
    var scores = [
      fuzzyScore(med.name, query) * 2,
      fuzzyScore(med.brand, query) * 1.8,
      fuzzyScore(med.class, query) * 1.2,
      fuzzyScore(med.category, query),
      fuzzyScore(med.indications, query) * 0.5
    ];
    return Math.max(...scores);
  }

  function getFilteredMeds() {
    var q = medSearchQuery.toLowerCase().trim();
    var filtered = medications;
    // Category filter
    if (medActiveCat !== 'all') {
      filtered = filtered.filter(m => m.category === medActiveCat);
    }
    // Search filter + scoring
    if (q) {
      filtered = filtered
        .map(m => ({ med: m, score: getMedMatchScore(m, q) }))
        .filter(x => x.score > 0)
        .sort((a, b) => b.score - a.score)
        .map(x => x.med);
    }
    return filtered;
  }

  function renderMedList() {
    var r = document.getElementById('medResults');
    var q = medSearchQuery;

    if (selectedMed) {
      renderMedDetail(selectedMed, q);
      return;
    }

    var clearBtn = document.getElementById('medClearBtn');
    clearBtn.style.display = q ? 'flex' : 'none';

    if (!q && medActiveCat === 'all') {
      r.innerHTML = '<div class="med-search-hint"><span class="hint-icon">üíä</span>Search by drug name, brand name, or category ‚Äî or tap a category above to browse</div>';
      return;
    }

    var filtered = getFilteredMeds();
    if (!filtered.length) {
      r.innerHTML = '<div class="med-no-results"><span class="med-no-results-icon">üîç</span><p>No medications found for "<strong>' + q + '</strong>"</p><p style="margin-top:6px;font-size:12px;">Try searching by generic name, brand name, or drug class</p></div>';
      return;
    }

    r.innerHTML = '<div style="font-size:12px;color:var(--muted);margin-bottom:10px;">' + filtered.length + ' medication' + (filtered.length!==1?'s':'') + ' found' + (q ? ' for "' + q + '"' : '') + '</div>' +
      filtered.map(function(m, idx) {
        return '<div class="med-item" data-idx="' + medications.indexOf(m) + '">' +
          '<div class="med-item-icon">' + m.icon + '</div>' +
          '<div class="med-item-body">' +
          '<div class="med-name">' + highlight(m.name, q) + '</div>' +
          (m.brand ? '<div class="med-generic">' + highlight(m.brand, q) + '</div>' : '') +
          '<div class="med-class"><span class="med-class-tag">' + m.category + '</span> ' + highlight(m.class, q) + '</div>' +
          '</div>' +
          '<div class="med-arrow">‚Ä∫</div>' +
          '</div>';
      }).join('');
  }

  function renderMedDetail(med, q) {
    var r = document.getElementById('medResults');
    r.innerHTML =
      '<button class="med-back-btn" id="medBackBtn">‚Üê Back to results</button>' +
      '<div class="med-detail-view">' +
        '<div class="med-detail-header">' +
          '<div class="med-detail-name">' + med.icon + ' ' + med.name + '</div>' +
          (med.brand ? '<div class="med-detail-generic">Brand: ' + med.brand + '</div>' : '') +
          '<span class="med-detail-class">' + med.class + '</span>' +
        '</div>' +

        '<div class="med-detail-section">' +
          '<h4>üéØ Indications</h4><p>' + med.indications + '</p>' +
        '</div>' +

        '<div class="med-detail-section">' +
          '<h4>üìè Dosage & Route</h4>' +
          '<div class="med-tags" style="margin-bottom:8px;">' + (med.route||'').split(',').map(r=>'<span class="med-tag-blue">'+r.trim()+'</span>').join('') + '</div>' +
          '<p>' + med.dosage + '</p>' +
        '</div>' +

        '<div class="med-detail-section">' +
          '<h4>‚ö†Ô∏è Side Effects</h4>' +
          '<div class="med-tags">' + med.sideEffects.map(s=>'<span class="med-tag-yellow">'+s+'</span>').join('') + '</div>' +
        '</div>' +

        '<div class="med-detail-section">' +
          '<h4>ü©∫ Nursing Considerations</h4>' +
          '<div class="med-nursing-box"><p>' + med.nursing + '</p></div>' +
        '</div>' +

        '<div class="med-detail-section">' +
          '<h4>üö´ Contraindications</h4>' +
          '<div class="med-tags">' + med.contraindications.split(',').map(c=>'<span class="med-tag-red">'+c.trim()+'</span>').join('') + '</div>' +
        '</div>' +

        (med.antidote ? '<div class="med-detail-section"><h4>üíä Antidote</h4><p style="color:var(--success);font-weight:600;">'+med.antidote+'</p></div>' : '') +

      '</div>';

    document.getElementById('medBackBtn').addEventListener('click', function() {
      selectedMed = null;
      renderMedList();
    });
  }

  // PHOTOS
  function savePhotos(){localStorage.setItem(PHOTOS_KEY,JSON.stringify(notePhotos));}
  function renderPhotos(){document.getElementById('photoPreviewContainer').innerHTML=notePhotos.map((p,i)=>`<div class="photo-preview"><img src="${p}" alt="Note photo"><button class="photo-delete" onclick="deletePhoto(${i})">√ó</button></div>`).join('');}
  window.deletePhoto=i=>{if(confirm('Delete this photo?')){notePhotos.splice(i,1);savePhotos();renderPhotos();}};

  // NOTES
  function saveNotes(){localStorage.setItem(NOTES_KEY,document.getElementById('quickNotes').value);savePhotos();alert('‚úì Notes saved!');}
  function loadNotes(){document.getElementById('quickNotes').value=localStorage.getItem(NOTES_KEY)||'';}

  // CHECKLIST
  function saveChecklist(){var states=Array.from(document.querySelectorAll('.checklist input[type="checkbox"]')).map(cb=>cb.checked);localStorage.setItem(CHECKLIST_KEY,JSON.stringify(states));}
  function loadChecklist(){var saved=localStorage.getItem(CHECKLIST_KEY);if(saved){var s=JSON.parse(saved);document.querySelectorAll('.checklist input[type="checkbox"]').forEach((cb,i)=>cb.checked=s[i]||false);}}
  function resetChecklist(){document.querySelectorAll('.checklist input[type="checkbox"]').forEach(cb=>cb.checked=false);saveChecklist();}

  // THEME
  function toggleTheme(){document.body.classList.toggle('dark');var dark=document.body.classList.contains('dark');localStorage.setItem('theme',dark?'dark':'light');document.getElementById('themeBtn').innerText=dark?'‚òÄÔ∏è':'üåô';}
  function loadTheme(){if(localStorage.getItem('theme')==='dark'){document.body.classList.add('dark');document.getElementById('themeBtn').innerText='‚òÄÔ∏è';}}

  // TABS
  function switchTab(name){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));document.querySelector('.tab[data-tab="'+name+'"]').classList.add('active');document.getElementById(name+'Tab').classList.add('active');}

  // CALENDAR
  function renderCalendar(){
    var yr=currentDate.getFullYear(),mo=currentDate.getMonth();
    var months=['January','February','March','April','May','June','July','August','September','October','November','December'];
    document.getElementById('calendarMonth').innerText=months[mo]+' '+yr;
    var firstDay=new Date(yr,mo,1).getDay();
    var daysInMonth=new Date(yr,mo+1,0).getDate();
    var prevDays=new Date(yr,mo,0).getDate();
    var cal=document.getElementById('calendar');
    cal.innerHTML=''; cal.className='calendar-grid';
    ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d=>{var h=document.createElement('div');h.className='calendar-day-header';h.innerText=d;cal.appendChild(h);});
    var todayStr=new Date().toISOString().split('T')[0];
    for(var i=firstDay-1;i>=0;i--){var d=document.createElement('div');d.className='calendar-day other-month';d.innerHTML='<div class="calendar-day-number">'+(prevDays-i)+'</div>';cal.appendChild(d);}
    for(var day=1;day<=daysInMonth;day++){
      var el=document.createElement('div');el.className='calendar-day';
      var ds=yr+'-'+String(mo+1).padStart(2,'0')+'-'+String(day).padStart(2,'0');
      if(ds===todayStr)el.classList.add('today');
      if(tasks.some(t=>t.date===ds))el.classList.add('has-tasks');
      if(selectedDate===ds)el.classList.add('selected');
      el.innerHTML='<div class="calendar-day-number">'+day+'</div>';
      el.dataset.date=ds; cal.appendChild(el);
    }
    var total=cal.children.length-7;
    for(var r=1;r<=42-total-7;r++){var re=document.createElement('div');re.className='calendar-day other-month';re.innerHTML='<div class="calendar-day-number">'+r+'</div>';cal.appendChild(re);}
  }
  function selectDate(ds){selectedDate=ds;renderCalendar();showDayEvents(ds);}
  function showDayEvents(ds){
    var c=document.getElementById('dayEvents');
    var dt=tasks.filter(t=>t.date===ds);
    if(!dt.length){c.innerHTML='<div style="text-align:center;color:var(--muted);padding:20px;">No tasks for '+formatDate(ds)+'</div>';return;}
    var p=ds.split('-'),date=new Date(+p[0],+p[1]-1,+p[2]);
    c.innerHTML='<h3 style="margin-bottom:12px;font-size:16px;">Tasks for '+date.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'})+'</h3>';
    dt.forEach(task=>{var div=document.createElement('div');div.className='event-item priority-'+task.priority;div.innerHTML='<div style="display:flex;justify-content:space-between;align-items:center;"><div><div style="font-weight:600;margin-bottom:4px;">'+task.text+'</div><div style="font-size:12px;color:var(--muted);">'+task.subject+' ¬∑ '+task.priority.toUpperCase()+'</div></div>'+(task.done?'<span style="color:var(--success);font-size:20px;">‚úì</span>':'')+'</div>';c.appendChild(div);});
  }

  // EVENT LISTENERS
  document.getElementById('themeBtn').addEventListener('click', toggleTheme);
  document.getElementById('addTaskBtn').addEventListener('click', addTask);
  document.getElementById('startTimerBtn').addEventListener('click', startTimer);
  document.getElementById('pauseTimerBtn').addEventListener('click', pauseTimer);
  document.getElementById('resetTimerBtn').addEventListener('click', resetTimer);
  document.getElementById('setCustomTimerBtn').addEventListener('click', setCustomTimer);
  document.getElementById('calculateBtn').addEventListener('click', calculate);
  document.getElementById('calculateIVBtn').addEventListener('click', calculateIV);
  document.getElementById('saveNotesBtn').addEventListener('click', saveNotes);
  document.getElementById('resetChecklistBtn').addEventListener('click', resetChecklist);
  document.getElementById('prevMonthBtn').addEventListener('click', ()=>{currentDate.setMonth(currentDate.getMonth()-1);renderCalendar();if(selectedDate)showDayEvents(selectedDate);});
  document.getElementById('nextMonthBtn').addEventListener('click', ()=>{currentDate.setMonth(currentDate.getMonth()+1);renderCalendar();if(selectedDate)showDayEvents(selectedDate);});

  document.getElementById('medSearch').addEventListener('input', function() {
    medSearchQuery = this.value;
    selectedMed = null;
    renderMedList();
  });
  document.getElementById('medClearBtn').addEventListener('click', function() {
    document.getElementById('medSearch').value = '';
    medSearchQuery = '';
    selectedMed = null;
    renderMedList();
  });
  document.getElementById('medCategoryFilters').addEventListener('click', function(e) {
    var btn = e.target.closest('.med-cat-btn');
    if (!btn) return;
    medActiveCat = btn.dataset.cat;
    selectedMed = null;
    document.querySelectorAll('.med-cat-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderMedList();
  });
  document.getElementById('medResults').addEventListener('click', function(e) {
    var item = e.target.closest('.med-item[data-idx]');
    if (item) {
      selectedMed = medications[parseInt(item.dataset.idx)];
      renderMedDetail(selectedMed, medSearchQuery);
    }
  });

  document.getElementById('photoInput').addEventListener('change', function(e) {
    Array.from(e.target.files).forEach(file=>{var r=new FileReader();r.onload=ev=>{notePhotos.push(ev.target.result);renderPhotos();};r.readAsDataURL(file);});
    e.target.value='';
  });
  document.querySelectorAll('.filter-tab').forEach(tab=>tab.addEventListener('click',function(){filterTasks(this.dataset.filter);}));
  document.querySelectorAll('.tab').forEach(tab=>tab.addEventListener('click',function(){switchTab(this.dataset.tab);}));
  document.querySelectorAll('.preset-btn').forEach(btn=>btn.addEventListener('click',function(){setTimerPreset(parseInt(this.dataset.minutes),this);}));
  document.getElementById('taskList').addEventListener('click', function(e) {
    var btn=e.target.closest('[data-action]');
    if(btn){var a=btn.dataset.action,i=parseInt(btn.dataset.index);if(a==='toggle')toggleTask(i);else if(a==='remove')removeTask(i);}
  });
  document.getElementById('calendar').addEventListener('click', function(e) {
    var d=e.target.closest('.calendar-day');
    if(d&&d.dataset.date&&!d.classList.contains('other-month'))selectDate(d.dataset.date);
  });
  document.getElementById('checklist').addEventListener('change', saveChecklist);
  window.addEventListener('resize', ()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});

  // INIT
  loadTheme(); loadNotes(); renderPhotos(); loadChecklist();
  render(); renderCalendar(); updateTimerDisplay(); renderMedList();
  updateGraduationCountdown();
  setInterval(updateGraduationCountdown, 60000);

  var sp = localStorage.getItem(TIMER_PRESET_KEY);
  if(sp){timerPresetMinutes=parseInt(sp);timerSeconds=timerPresetMinutes*60;updateTimerDisplay();document.querySelectorAll('.preset-btn').forEach(b=>{if(parseInt(b.dataset.minutes)===timerPresetMinutes)b.classList.add('active');});}
  document.getElementById('taskDate').valueAsDate = new Date();
})();
</script>
</body>
</html>
